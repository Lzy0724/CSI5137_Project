{"name": "testEmptyProject", "input_sql": "select z + x from (\n  select x + y as z, x from (\n    select * from (values (10, 1), (30, 3)) as t (x, y)\n    where x + y > 50) as t) as t;", "input_cost": 0.04, "output_sql": "SELECT *\r\nFROM (VALUES (CAST(NULL AS INTEGER))) AS \"t\" (\"EXPR$0\")\r\nWHERE 1 = 0;", "output_cost": 0.01, "used_rules": ["PROJECT_FILTER_VALUES_MERGE"], "rewrite_time": 1045}
{"name": "testEmptyFilterProjectUnion", "input_sql": "select * from (\nselect * from (values (10, 1), (30, 3)) as t (x, y)\nunion all\nselect * from (values (20, 2)) as t (x, y)\n) as t\nwhere x + y > 30;", "input_cost": 0.03, "output_sql": "SELECT *\r\nFROM (VALUES (30, 3)) AS \"t\" (\"x\", \"y\");", "output_cost": 0.01, "used_rules": ["FILTER_SET_OP_TRANSPOSE", "FILTER_REDUCE_EXPRESSIONS", "PROJECT_REDUCE_EXPRESSIONS", "FILTER_PROJECT_TRANSPOSE", "PROJECT_FILTER_VALUES_MERGE", "UNION_INSTANCE", "PROJECT_REDUCE_EXPRESSIONS", "PROJECT_VALUES_MERGE"], "rewrite_time": 392}
{"name": "testNotPushFilterPastWindowWhenPredicateNotOnPartitionKey", "input_sql": "select * from\n(select NAME, DEPTNO, count(*) over (partition by NAME) from dept) t\nwhere DEPTNO = 0;", "input_cost": 126.27, "output_sql": "SELECT \"name\", CAST(0 AS INTEGER) AS \"deptno\", COUNT(*) OVER (PARTITION BY \"name\" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\r\nFROM \"dept\"\r\nWHERE \"deptno\" = 0;", "output_cost": 8.2, "used_rules": ["PROJECT_REDUCE_EXPRESSIONS", "PROJECT_TO_CALC"], "rewrite_time": 413}
{"name": "testDecorrelateTwoExists", "input_sql": "select * from emp\nwhere EXISTS (\n  select * from emp e where emp.deptno = e.deptno)\nAND NOT EXISTS (\n  select * from emp ee where ee.job = emp.job AND ee.sal=34);", "input_cost": 68.65, "output_sql": "SELECT *\r\nFROM \"emp\"\r\nWHERE EXISTS (SELECT *\r\n        FROM \"emp\" AS \"emp0\" (\"empno0\", \"ename0\", \"job0\", \"mgr0\", \"hiredate0\", \"sal0\", \"comm0\", \"deptno0\", \"slacker0\")\r\n        WHERE \"emp\".\"deptno\" = \"deptno0\") AND NOT EXISTS (SELECT *\r\n        FROM \"emp\" AS \"emp1\" (\"empno1\", \"ename1\", \"job1\", \"mgr1\", \"hiredate1\", \"sal1\", \"comm1\", \"deptno1\", \"slacker1\")\r\n        WHERE \"job1\" = \"emp\".\"job\" AND \"sal1\" = 34);", "output_cost": 68.65, "used_rules": ["PROJECT_REMOVE"], "rewrite_time": 999}
{"name": "testEmptyMinus", "input_sql": "select * from (values (30, 3)) as t (x, y)\nwhere x > 30\nexcept\nselect * from (values (20, 2)) as t (x, y)\nexcept\nselect * from (values (40, 4)) as t (x, y);", "input_cost": 0.06, "output_sql": "SELECT *\r\nFROM (VALUES (CAST(NULL AS INTEGER), CAST(NULL AS INTEGER))) AS \"t\" (\"x\", \"y\")\r\nWHERE 1 = 0;", "output_cost": 0.01, "used_rules": ["PROJECT_FILTER_VALUES_MERGE", "PROJECT_REDUCE_EXPRESSIONS", "PROJECT_VALUES_MERGE", "MINUS_INSTANCE"], "rewrite_time": 103}
{"name": "testIsNullPushDown2", "input_sql": "select empno, deptno, w_count from (\n  select empno, deptno, count(empno) over (ROWS BETWEEN 10 PRECEDING AND 1 PRECEDING) w_count\n  from emp\n) sub_query where w_count is null;", "input_cost": 32.42, "output_sql": "SELECT *\r\nFROM (VALUES (CAST(NULL AS INTEGER), CAST(NULL AS INTEGER), CAST(NULL AS BIGINT))) AS \"t\" (\"empno\", \"deptno\", \"w_count\")\r\nWHERE 1 = 0;", "output_cost": 0.01, "used_rules": ["FILTER_REDUCE_EXPRESSIONS", "PROJECT_REMOVE"], "rewrite_time": 62}
{"name": "testDistinctWithGrouping", "input_sql": "SELECT sal, SUM(comm), MIN(comm), SUM(DISTINCT sal)\nFROM emp\nGROUP BY sal;", "input_cost": 60.06, "output_sql": "SELECT \"sal\", SUM(\"comm\"), MIN(\"comm\"), SUM(DISTINCT \"sal\")\r\nFROM \"emp\"\r\nGROUP BY \"sal\";", "output_cost": 60.06, "used_rules": ["PROJECT_TO_CALC"], "rewrite_time": 428}
{"name": "testWhereNotInCorrelated", "input_sql": "select sal from emp\nwhere empno NOT IN (\n  select deptno from dept\n  where emp.job = dept.name);", "input_cost": 8950.67, "output_sql": "SELECT \"sal\"\r\nFROM \"emp\"\r\nWHERE \"empno\" NOT IN (SELECT \"deptno0\"\r\n            FROM \"dept\" AS \"dept\" (\"deptno0\", \"name\")\r\n            WHERE \"emp\".\"job\" = \"name\");", "output_cost": 8950.67, "used_rules": ["PROJECT_TO_CALC"], "rewrite_time": 587}
{"name": "testSelectAnyCorrelated", "input_sql": "select empno > ANY (\n  select deptno from dept where emp.job = dept.name)\nfrom emp;", "input_cost": 8950.67, "output_sql": "select empno > ANY (\n  select deptno from dept where emp.job = dept.name)\nfrom emp;", "output_cost": 8950.67, "used_rules": [], "rewrite_time": 317}
{"name": "testWhereInCorrelated", "input_sql": "select sal from emp where empno IN (\n  select deptno from dept where emp.job = dept.name);", "input_cost": 56.62, "output_sql": "SELECT \"sal\"\r\nFROM \"emp\"\r\nWHERE \"empno\" IN (SELECT \"deptno0\"\r\n            FROM \"dept\" AS \"dept\" (\"deptno0\", \"name\")\r\n            WHERE \"emp\".\"job\" = \"name\");", "output_cost": 56.62, "used_rules": ["PROJECT_TO_CALC"], "rewrite_time": 227}
{"name": "testJoinConditionPushdown6", "input_sql": "select *\nfrom emp e right join dept d\non e.deptno = d.deptno and e.empno = d.deptno;", "input_cost": 56.62, "output_sql": "SELECT *\r\nFROM \"emp\"\r\n    RIGHT JOIN \"dept\" AS \"dept\" (\"deptno0\", \"name\") ON \"emp\".\"deptno\" = \"dept\".\"deptno0\" AND \"emp\".\"empno\" = \"dept\".\"deptno0\";", "output_cost": 56.62, "used_rules": ["PROJECT_REMOVE"], "rewrite_time": 84}
{"name": "testWhereOrSubQuery", "input_sql": "select * from emp\nwhere sal = 4\nor empno NOT IN (select deptno from dept);", "input_cost": 46.23, "output_sql": "SELECT *\r\nFROM \"emp\"\r\nWHERE \"sal\" = 4 OR \"empno\" NOT IN (SELECT \"deptno0\"\r\n            FROM \"dept\" AS \"dept\" (\"deptno0\", \"name\"));", "output_cost": 46.23, "used_rules": ["PROJECT_REMOVE"], "rewrite_time": 308}
{"name": "testSome", "input_sql": "select * from emp e1\n  where e1.empno > SOME (select deptno from dept);", "input_cost": 2403.11, "output_sql": "select * from emp e1\n  where e1.empno > SOME (select deptno from dept);", "output_cost": 2403.11, "used_rules": [], "rewrite_time": 300}
{"name": "testPushAggregateFunctionsThroughJoin", "input_sql": "select e.job,\n  min(sal) as min_sal, min(e.deptno) as min_deptno,\n  sum(sal) + 1 as sum_sal_plus, max(sal) as max_sal,\n  sum(sal) as sum_sal_2, count(sal) as count_sal,\n  count(mgr) as count_mgr\nfrom emp as e\njoin dept as d on e.job = d.name\ngroup by e.job,d.name;", "input_cost": 285.97, "output_sql": "SELECT \"t\".\"job\", \"t\".\"min_sal\", \"t\".\"min_deptno\", \"t\".\"sum_sal_2\" * \"t0\".\"$f1\" + 1 AS \"sum_sal_2\", \"t\".\"max_sal\", \"t\".\"sum_sal_2\" * \"t0\".\"$f1\" AS \"count_sal\", \"t\".\"count_sal\" * \"t0\".\"$f1\" AS \"count_mgr\", \"t\".\"count_mgr\" * \"t0\".\"$f1\" AS \"name\"\r\nFROM (SELECT \"job\", MIN(\"sal\") AS \"min_sal\", MIN(\"deptno\") AS \"min_deptno\", COALESCE(SUM(\"sal\"), 0) AS \"sum_sal_2\", MAX(\"sal\") AS \"max_sal\", COUNT(*) AS \"count_sal\", COUNT(\"mgr\") AS \"count_mgr\"\r\n        FROM \"emp\"\r\n        GROUP BY \"job\") AS \"t\",\r\n        (SELECT \"name\", COUNT(*) AS \"$f1\"\r\n        FROM \"dept\" AS \"dept\" (\"deptno0\", \"name\")\r\n        GROUP BY \"name\") AS \"t0\"\r\nWHERE \"t\".\"job\" = \"t0\".\"name\";", "output_cost": 69.56, "used_rules": ["AGGREGATE_PROJECT_MERGE", "AGGREGATE_REDUCE_FUNCTIONS", "AGGREGATE_JOIN_TRANSPOSE_EXTENDED", "PROJECT_TO_CALC", "CALC_MERGE", "JOIN_EXTRACT_FILTER"], "rewrite_time": 489}
{"name": "testReduceConstantsCalc", "input_sql": "select * from (\n  select upper(substring(x FROM 1 FOR 2) || substring(x FROM 3)) as u,\n      substring(x FROM 1 FOR 1) as s\n  from (\n    select 'table' as x from (values (true)) as t (a)\n    union\n    select 'view' from (values (true)) as t (a)\n    union\n    select 'foreign table' from (values (true)) as t (a)\n  ) as t\n) as t where u = 'TABLE';", "input_cost": 0.12, "output_sql": "SELECT *\r\nFROM (VALUES ('TABLE', 't')) AS \"t\" (\"u\", \"s\");", "output_cost": 0.01, "used_rules": ["PROJECT_REDUCE_EXPRESSIONS", "FILTER_PROJECT_TRANSPOSE", "FILTER_SET_OP_TRANSPOSE", "FILTER_REDUCE_EXPRESSIONS", "UNION_INSTANCE", "PROJECT_REDUCE_EXPRESSIONS", "PROJECT_VALUES_MERGE"], "rewrite_time": 111}
{"name": "testReduceConstantsNegatedInverted", "input_sql": "select empno from emp where empno>10 and empno<=10;", "input_cost": 11.3, "output_sql": "SELECT \"empno\"\r\nFROM (VALUES (CAST(NULL AS INTEGER), CAST(NULL AS VARCHAR), CAST(NULL AS VARCHAR), CAST(NULL AS INTEGER), CAST(NULL AS DATE), CAST(NULL AS INTEGER), CAST(NULL AS INTEGER), CAST(NULL AS INTEGER), CAST(NULL AS BOOLEAN))) AS \"t\" (\"empno\", \"ename\", \"job\", \"mgr\", \"hiredate\", \"sal\", \"comm\", \"deptno\", \"slacker\")\r\nWHERE 1 = 0;", "output_cost": 0.01, "used_rules": ["FILTER_REDUCE_EXPRESSIONS", "PROJECT_TO_CALC"], "rewrite_time": 32}
{"name": "testDecorrelateTwoIn", "input_sql": "select sal\nfrom emp\nwhere empno IN (\n  select deptno from dept where emp.job = dept.name)\nAND empno IN (\n  select empno from emp e where emp.ename = e.ename);", "input_cost": 56.57, "output_sql": "SELECT \"sal\"\r\nFROM \"emp\"\r\nWHERE \"empno\" IN (SELECT \"deptno0\"\r\n            FROM \"dept\" AS \"dept\" (\"deptno0\", \"name\")\r\n            WHERE \"emp\".\"job\" = \"name\") AND \"empno\" IN (SELECT \"empno0\"\r\n            FROM \"emp\" AS \"emp0\" (\"empno0\", \"ename0\", \"job0\", \"mgr0\", \"hiredate0\", \"sal0\", \"comm0\", \"deptno1\", \"slacker0\")\r\n            WHERE \"emp\".\"ename\" = \"ename0\");", "output_cost": 56.57, "used_rules": ["PROJECT_TO_CALC"], "rewrite_time": 260}
{"name": "testAggregateRemove1", "input_sql": "select empno, sum(sal), min(sal), max(sal),\n bit_and(distinct sal), bit_or(sal), count(distinct sal),\n grouping(deptno)\nfrom emp\ngroup by empno, deptno;", "input_cost": 71.86, "output_sql": "SELECT \"empno\", SUM(\"sal\"), MIN(\"sal\"), MAX(\"sal\"), BIT_AND(\"sal\"), BIT_OR(\"sal\"), COUNT(DISTINCT \"sal\"), GROUPING(\"deptno\")\r\nFROM \"emp\"\r\nGROUP BY \"empno\", \"deptno\";", "output_cost": 71.86, "used_rules": ["PROJECT_TO_CALC"], "rewrite_time": 281}
{"name": "testAggregateRemove2", "input_sql": "select distinct empno, deptno from emp;", "input_cost": 27.25, "output_sql": "SELECT \"empno\", \"deptno\"\r\nFROM \"emp\";", "output_cost": 16.9, "used_rules": ["PROJECT_TO_CALC"], "rewrite_time": 16}
{"name": "testAggregateRemove3", "input_sql": "select empno, count(mgr) from emp group by empno, deptno;", "input_cost": 27.25, "output_sql": "SELECT \"empno\", CASE WHEN \"mgr\" IS NOT NULL THEN 1 ELSE 0 END\r\nFROM \"emp\";", "output_cost": 16.9, "used_rules": ["AGGREGATE_PROJECT_MERGE", "AGGREGATE_REMOVE", "PROJECT_TO_CALC", "CALC_MERGE"], "rewrite_time": 37}
{"name": "testWhereAnyCorrelatedInSelect", "input_sql": "select * from emp where empno > ANY (\n  select deptno from dept where emp.job = dept.name);", "input_cost": 61.44, "output_sql": "select * from emp where empno > ANY (\n  select deptno from dept where emp.job = dept.name);", "output_cost": 61.44, "used_rules": [], "rewrite_time": 333}
{"name": "testReduceConstantsIsNull", "input_sql": "select empno from emp where empno=10 and empno is null;", "input_cost": 0.0, "output_sql": "SELECT \"empno\"\r\nFROM (VALUES (CAST(NULL AS INTEGER), CAST(NULL AS VARCHAR), CAST(NULL AS VARCHAR), CAST(NULL AS INTEGER), CAST(NULL AS DATE), CAST(NULL AS INTEGER), CAST(NULL AS INTEGER), CAST(NULL AS INTEGER), CAST(NULL AS BOOLEAN))) AS \"t\" (\"empno\", \"ename\", \"job\", \"mgr\", \"hiredate\", \"sal\", \"comm\", \"deptno\", \"slacker\")\r\nWHERE 1 = 0;", "output_cost": 0.01, "used_rules": ["FILTER_REDUCE_EXPRESSIONS", "PROJECT_TO_CALC"], "rewrite_time": 19}
{"name": "testReduceConstantsNegated", "input_sql": "select empno from emp\nwhere empno=10 and not(empno=10);", "input_cost": 8.17, "output_sql": "SELECT \"empno\"\r\nFROM (VALUES (CAST(NULL AS INTEGER), CAST(NULL AS VARCHAR), CAST(NULL AS VARCHAR), CAST(NULL AS INTEGER), CAST(NULL AS DATE), CAST(NULL AS INTEGER), CAST(NULL AS INTEGER), CAST(NULL AS INTEGER), CAST(NULL AS BOOLEAN))) AS \"t\" (\"empno\", \"ename\", \"job\", \"mgr\", \"hiredate\", \"sal\", \"comm\", \"deptno\", \"slacker\")\r\nWHERE 1 = 0;", "output_cost": 0.01, "used_rules": ["FILTER_REDUCE_EXPRESSIONS", "PROJECT_TO_CALC"], "rewrite_time": 23}
{"name": "testIsNullPushDown", "input_sql": "select empno, deptno, w_count from (\n  select empno, deptno, count(empno) over (w) w_count\n  from emp\n  window w as (partition by deptno order by empno)\n) sub_query where w_count is null;", "input_cost": 70.14, "output_sql": "SELECT *\r\nFROM (VALUES (CAST(NULL AS INTEGER), CAST(NULL AS INTEGER), CAST(NULL AS BIGINT))) AS \"t\" (\"empno\", \"deptno\", \"w_count\")\r\nWHERE 1 = 0;", "output_cost": 0.01, "used_rules": ["FILTER_REDUCE_EXPRESSIONS", "PROJECT_REMOVE"], "rewrite_time": 12}
{"name": "testMaxReuseDistinctAttrWithMixedOptionality", "input_sql": "select sum(distinct deptno), count(distinct deptno), max(deptno) from emp;", "input_cost": 56.35, "output_sql": "SELECT CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(\"deptno\"), 0) END, COUNT(*), MAX(\"deptno\")\r\nFROM (SELECT \"deptno\"\r\n        FROM \"emp\"\r\n        GROUP BY \"deptno\") AS \"t\";", "output_cost": 22.14, "used_rules": ["AGGREGATE_EXPAND_DISTINCT_AGGREGATES", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC"], "rewrite_time": 154}
{"name": "testSumAndDistinctSumWithExpandSumType", "input_sql": "SELECT SUM(comm), SUM(DISTINCT comm) FROM emp;", "input_cost": 54.62, "output_sql": "SELECT MIN(\"EXPR$0\") FILTER (WHERE \"$g_1\"), CASE WHEN (COUNT(\"comm\") FILTER (WHERE \"$g_0\")) = 0 THEN NULL ELSE COALESCE(SUM(\"comm\") FILTER (WHERE \"$g_0\"), 0) END\r\nFROM (SELECT \"comm\", COALESCE(SUM(\"comm\"), 0) AS \"EXPR$0\", GROUPING(\"comm\") = 0 AS \"$g_0\", GROUPING(\"comm\") = 1 AS \"$g_1\"\r\n        FROM \"emp\"\r\n        GROUP BY ROLLUP(\"comm\")) AS \"t0\";", "output_cost": 29.63, "used_rules": ["AGGREGATE_EXPAND_DISTINCT_AGGREGATES", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC"], "rewrite_time": 118}
{"name": "testAggregateMerge1", "input_sql": "select deptno c, min(y), max(z) z,\nsum(r), sum(m) n, sum(x) sal from (\n   select deptno, ename, sum(sal) x, max(sal) z,\n      min(sal) y, count(hiredate) m, count(mgr) r\n   from emp group by deptno, ename) t\ngroup by deptno;", "input_cost": 39.47, "output_sql": "SELECT \"deptno\", MIN(\"sal\"), MAX(\"sal\") AS \"z\", COUNT(\"mgr\"), COUNT(*) AS \"n\", COALESCE(SUM(\"sal\"), 0) AS \"sal\"\r\nFROM \"emp\"\r\nGROUP BY \"deptno\";", "output_cost": 29.25, "used_rules": ["AGGREGATE_PROJECT_MERGE", "AGGREGATE_MERGE", "AGGREGATE_REDUCE_FUNCTIONS"], "rewrite_time": 35}
{"name": "testReduceValuesToEmpty", "input_sql": "select a + b as x, b, a from (values (10, 1), (30, 7)) as t(a, b)\nwhere a - b < 0;", "input_cost": 0.04, "output_sql": "SELECT *\r\nFROM (VALUES (CAST(NULL AS INTEGER), CAST(NULL AS INTEGER), CAST(NULL AS INTEGER))) AS \"t\" (\"x\", \"b\", \"a\")\r\nWHERE 1 = 0;", "output_cost": 0.01, "used_rules": ["PROJECT_FILTER_VALUES_MERGE"], "rewrite_time": 14}
{"name": "testAggregateMergeSum0", "input_sql": "select coalesce(sum(count_comm), 0)\nfrom (\n  select deptno, count(comm) as count_comm\n  from emp\n  group by deptno, mgr) t;", "input_cost": 26.59, "output_sql": "SELECT COUNT(*) AS \"$f0\"\r\nFROM \"emp\";", "output_cost": 18.64, "used_rules": ["PROJECT_AGGREGATE_MERGE", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_MERGE"], "rewrite_time": 33}
{"name": "testPushAggregateThroughOuterJoin14", "input_sql": "select e.mgr, d.mgr\nfrom emp as e\nfull outer join emp as d on e.mgr = d.mgr\ngroup by d.mgr, e.mgr;", "input_cost": 163.16, "output_sql": "SELECT \"t\".\"mgr\", \"t0\".\"mgr0\"\r\nFROM (SELECT \"mgr\"\r\n        FROM \"emp\"\r\n        GROUP BY \"mgr\") AS \"t\"\r\n    FULL JOIN (SELECT \"mgr0\"\r\n        FROM \"emp\" AS \"emp0\" (\"empno0\", \"ename0\", \"job0\", \"mgr0\", \"hiredate0\", \"sal0\", \"comm0\", \"deptno0\", \"slacker0\")\r\n        GROUP BY \"mgr0\") AS \"t0\" ON \"t\".\"mgr\" = \"t0\".\"mgr0\"\r\nGROUP BY \"t\".\"mgr\", \"t0\".\"mgr0\";", "output_cost": 47.29, "used_rules": ["AGGREGATE_PROJECT_MERGE", "AGGREGATE_JOIN_TRANSPOSE_EXTENDED", "PROJECT_TO_CALC", "CALC_MERGE", "CALC_REMOVE"], "rewrite_time": 148}
{"name": "testPushFilterPastAggWithGroupingSets2", "input_sql": "select dname, ddeptno, c from\n             (select name dname, deptno ddeptno, count(*) as c\n             from dept group by grouping sets ((name,deptno),(name))) t\n              where dname = 'Charlie';", "input_cost": 71.65, "output_sql": "SELECT \"name\" AS \"dname\", \"deptno\" AS \"ddeptno\", COUNT(*) AS \"c\"\r\nFROM \"dept\"\r\nWHERE \"name\" = 'Charlie'\r\nGROUP BY GROUPING SETS((\"name\", \"deptno\"), \"name\");", "output_cost": 26.13, "used_rules": ["FILTER_AGGREGATE_TRANSPOSE", "FILTER_PROJECT_TRANSPOSE", "PROJECT_REMOVE", "PROJECT_TO_CALC"], "rewrite_time": 163}
{"name": "testBitOrReuseDistinctAttrWithMixedOptionality", "input_sql": "select sum(distinct deptno), count(distinct deptno), bit_or(deptno) from emp;", "input_cost": 56.35, "output_sql": "SELECT CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(\"deptno\"), 0) END, COUNT(*), BIT_OR(\"deptno\")\r\nFROM (SELECT \"deptno\"\r\n        FROM \"emp\"\r\n        GROUP BY \"deptno\") AS \"t\";", "output_cost": 22.14, "used_rules": ["AGGREGATE_EXPAND_DISTINCT_AGGREGATES", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC"], "rewrite_time": 69}
{"name": "testExistsWithAtLeastOneRowSubQuery", "input_sql": "select * from dept as d\nwhere EXISTS (\n  select count(*) from emp e where d.deptno = e.deptno);", "input_cost": 23698.68, "output_sql": "SELECT *\r\nFROM \"dept\";", "output_cost": 22.7, "used_rules": ["PROJECT_REMOVE", "FILTER_SUB_QUERY_TO_CORRELATE"], "rewrite_time": 11}
{"name": "testAnyInProjectNonNullable", "input_sql": "select name, deptno > ANY (\n  select deptno from emp)\nfrom dept;", "input_cost": 14043.5, "output_sql": "select name, deptno > ANY (\n  select deptno from emp)\nfrom dept;", "output_cost": 14043.5, "used_rules": [], "rewrite_time": 113}
{"name": "testAggregateJoinRemove4", "input_sql": "select distinct d.deptno\nfrom emp e\nright outer join dept d on e.deptno = d.deptno;", "input_cost": 73.17, "output_sql": "SELECT \"deptno\"\r\nFROM \"dept\";", "output_cost": 22.7, "used_rules": ["AGGREGATE_PROJECT_MERGE", "AGGREGATE_JOIN_REMOVE", "PROJECT_TO_CALC"], "rewrite_time": 40}
{"name": "testAggregateJoinRemove5", "input_sql": "select d.deptno, count(distinct d.name)\nfrom emp e\nright outer join dept d on e.deptno = d.deptno\ngroup by d.deptno;", "input_cost": 144.99, "output_sql": "SELECT \"deptno\", 1 AS \"$f1\"\r\nFROM \"dept\";", "output_cost": 22.7, "used_rules": ["AGGREGATE_EXPAND_DISTINCT_AGGREGATES", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_JOIN_REMOVE", "AGGREGATE_REMOVE", "PROJECT_TO_CALC"], "rewrite_time": 30}
{"name": "testSelectNotInCorrelated", "input_sql": "select sal,\n empno NOT IN (\n select deptno from dept\n   where emp.job=dept.name)\n from emp;", "input_cost": 8950.67, "output_sql": "select sal,\n empno NOT IN (\n select deptno from dept\n   where emp.job=dept.name)\n from emp;", "output_cost": 8950.67, "used_rules": [], "rewrite_time": 283}
{"name": "testDistinctCountWithExpandSumType", "input_sql": "SELECT count(comm), COUNT(DISTINCT comm) FROM emp;", "input_cost": 54.62, "output_sql": "SELECT CAST(MIN(\"EXPR$0\") FILTER (WHERE \"$g_1\") AS BIGINT), COUNT(\"comm\") FILTER (WHERE \"$g_0\")\r\nFROM (SELECT \"comm\", COUNT(*) AS \"EXPR$0\", GROUPING(\"comm\") = 0 AS \"$g_0\", GROUPING(\"comm\") = 1 AS \"$g_1\"\r\n        FROM \"emp\"\r\n        GROUP BY ROLLUP(\"comm\")) AS \"t0\";", "output_cost": 29.12, "used_rules": ["AGGREGATE_EXPAND_DISTINCT_AGGREGATES", "AGGREGATE_PROJECT_MERGE", "PROJECT_TO_CALC"], "rewrite_time": 85}
{"name": "testPullConstantIntoFilter", "input_sql": "select * from (select * from emp where deptno = 10) as t\nwhere deptno + 5 > empno;", "input_cost": 22.08, "output_sql": "SELECT \"empno\", \"ename\", \"job\", \"mgr\", \"hiredate\", \"sal\", \"comm\", 10 AS \"deptno\", \"slacker\"\r\nFROM \"emp\"\r\nWHERE \"deptno\" = 10 AND 15 > \"empno\";", "output_cost": 19.33, "used_rules": ["FILTER_REDUCE_EXPRESSIONS", "PROJECT_REDUCE_EXPRESSIONS", "FILTER_PROJECT_TRANSPOSE", "FILTER_MERGE", "PROJECT_TO_CALC", "CALC_MERGE"], "rewrite_time": 109}
{"name": "testEmptySortLimitZero", "input_sql": "select * from emp order by deptno limit 0;", "input_cost": 20.35, "output_sql": "SELECT *\r\nFROM (VALUES (CAST(NULL AS INTEGER), CAST(NULL AS VARCHAR), CAST(NULL AS VARCHAR), CAST(NULL AS INTEGER), CAST(NULL AS DATE), CAST(NULL AS INTEGER), CAST(NULL AS INTEGER), CAST(NULL AS INTEGER), CAST(NULL AS BOOLEAN))) AS \"t\" (\"empno\", \"ename\", \"job\", \"mgr\", \"hiredate\", \"sal\", \"comm\", \"deptno\", \"slacker\")\r\nWHERE 1 = 0;", "output_cost": 0.01, "used_rules": ["SORT_FETCH_ZERO_INSTANCE"], "rewrite_time": 18}
{"name": "testRemoveDistinctOnAgg", "input_sql": "SELECT empno, SUM(distinct sal), MIN(sal), MIN(distinct sal), MAX(distinct sal), bit_and(distinct sal), bit_or(sal), count(distinct sal) from emp group by empno, deptno;", "input_cost": 71.86, "output_sql": "SELECT \"empno\", COALESCE(SUM(\"sal\"), 0), MIN(\"sal\"), MIN(\"sal\"), MAX(\"sal\"), BIT_AND(\"sal\"), BIT_OR(\"sal\"), COUNT(*)\r\nFROM \"emp\"\r\nGROUP BY \"empno\", \"deptno\";", "output_cost": 35.88, "used_rules": ["AGGREGATE_EXPAND_DISTINCT_AGGREGATES", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_REDUCE_FUNCTIONS", "AGGREGATE_REMOVE", "AGGREGATE_PROJECT_MERGE", "PROJECT_TO_CALC"], "rewrite_time": 78}
{"name": "testEmptyIntersect", "input_sql": "select * from (values (30, 3)) as t (x, y) intersect\nselect *\nfrom (values (10, 1), (30, 3)) as t (x, y) where x > 50\nintersect\nselect * from (values (30, 3)) as t (x, y);", "input_cost": 0.07, "output_sql": "SELECT *\r\nFROM (VALUES (CAST(NULL AS INTEGER), CAST(NULL AS INTEGER))) AS \"t\" (\"x\", \"y\")\r\nWHERE 1 = 0;", "output_cost": 0.01, "used_rules": ["PROJECT_FILTER_VALUES_MERGE", "PROJECT_REDUCE_EXPRESSIONS", "PROJECT_VALUES_MERGE", "INTERSECT_INSTANCE"], "rewrite_time": 59}
{"name": "testExpandProjectInNullable", "input_sql": "with e2 as (\n  select empno, case when true then deptno else null end as deptno\n  from emp)\nselect empno,\n  deptno in (select deptno from e2 where empno < 20) as d\nfrom e2;", "input_cost": 48.52, "output_sql": "with e2 as (\n  select empno, case when true then deptno else null end as deptno\n  from emp)\nselect empno,\n  deptno in (select deptno from e2 where empno < 20) as d\nfrom e2;", "output_cost": 48.52, "used_rules": [], "rewrite_time": 270}
{"name": "testMinReuseDistinctAttrWithMixedOptionality", "input_sql": "select sum(distinct deptno), count(distinct deptno), min(deptno) from emp;", "input_cost": 56.35, "output_sql": "SELECT CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(\"deptno\"), 0) END, COUNT(*), MIN(\"deptno\")\r\nFROM (SELECT \"deptno\"\r\n        FROM \"emp\"\r\n        GROUP BY \"deptno\") AS \"t\";", "output_cost": 22.14, "used_rules": ["AGGREGATE_EXPAND_DISTINCT_AGGREGATES", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC"], "rewrite_time": 93}
