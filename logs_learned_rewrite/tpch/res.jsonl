{"name": "query1_0", "input_sql": "select\n\tl_returnflag,\n\tl_linestatus,\n\tsum(l_quantity) as sum_qty,\n\tsum(l_extendedprice) as sum_base_price,\n\tsum(l_extendedprice * (1 - l_discount)) as sum_disc_price,\n\tsum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,\n\tavg(l_quantity) as avg_qty,\n\tavg(l_extendedprice) as avg_price,\n\tavg(l_discount) as avg_disc,\n\tcount(*) as count_order\nfrom\n\tlineitem\nwhere\n\tl_shipdate <= date '1998-12-01' - interval '79' day\ngroup by\n\tl_returnflag,\n\tl_linestatus\norder by\n\tl_returnflag,\n\tl_linestatus\nlimit 1;", "input_cost": 2304297.73, "output_sql": "SELECT \"l_returnflag\", \"l_linestatus\", COALESCE(SUM(\"l_quantity\"), 0) AS \"sum_qty\", COALESCE(SUM(\"l_extendedprice\"), 0) AS \"sum_base_price\", COALESCE(SUM(\"l_extendedprice\" * (1 - \"l_discount\")), 0) AS \"sum_disc_price\", COALESCE(SUM(\"l_extendedprice\" * (1 - \"l_discount\") * (1 + \"l_tax\")), 0) AS \"sum_charge\", CAST(CAST(COALESCE(SUM(\"l_quantity\"), 0) AS DECIMAL(15, 2)) / COUNT(*) AS DECIMAL(15, 2)) AS \"avg_qty\", CAST(CAST(COALESCE(SUM(\"l_extendedprice\"), 0) AS DECIMAL(15, 2)) / COUNT(*) AS DECIMAL(15, 2)) AS \"avg_price\", CAST(CAST(COALESCE(SUM(\"l_discount\"), 0) AS DECIMAL(15, 2)) / COUNT(*) AS DECIMAL(15, 2)) AS \"avg_disc\", COUNT(*) AS \"count_order\"\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" <= DATE '1998-09-13'\r\nGROUP BY \"l_returnflag\", \"l_linestatus\"\r\nORDER BY \"l_returnflag\", \"l_linestatus\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 2304297.75, "used_rules": ["PROJECT_TO_CALC", "FILTER_REDUCE_EXPRESSIONS", "AGGREGATE_REDUCE_FUNCTIONS", "SORT_PROJECT_TRANSPOSE", "PROJECT_TO_CALC", "CALC_MERGE"], "rewrite_time": 2880}
{"name": "query1_1", "input_sql": "select\n\tl_returnflag,\n\tl_linestatus,\n\tsum(l_quantity) as sum_qty,\n\tsum(l_extendedprice) as sum_base_price,\n\tsum(l_extendedprice * (1 - l_discount)) as sum_disc_price,\n\tsum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,\n\tavg(l_quantity) as avg_qty,\n\tavg(l_extendedprice) as avg_price,\n\tavg(l_discount) as avg_disc,\n\tcount(*) as count_order\nfrom\n\tlineitem\nwhere\n\tl_shipdate <= date '1998-12-01' - interval '87' day\ngroup by\n\tl_returnflag,\n\tl_linestatus\norder by\n\tl_returnflag,\n\tl_linestatus\nlimit 1;", "input_cost": 2301993.92, "output_sql": "SELECT \"l_returnflag\", \"l_linestatus\", COALESCE(SUM(\"l_quantity\"), 0) AS \"sum_qty\", COALESCE(SUM(\"l_extendedprice\"), 0) AS \"sum_base_price\", COALESCE(SUM(\"l_extendedprice\" * (1 - \"l_discount\")), 0) AS \"sum_disc_price\", COALESCE(SUM(\"l_extendedprice\" * (1 - \"l_discount\") * (1 + \"l_tax\")), 0) AS \"sum_charge\", CAST(CAST(COALESCE(SUM(\"l_quantity\"), 0) AS DECIMAL(15, 2)) / COUNT(*) AS DECIMAL(15, 2)) AS \"avg_qty\", CAST(CAST(COALESCE(SUM(\"l_extendedprice\"), 0) AS DECIMAL(15, 2)) / COUNT(*) AS DECIMAL(15, 2)) AS \"avg_price\", CAST(CAST(COALESCE(SUM(\"l_discount\"), 0) AS DECIMAL(15, 2)) / COUNT(*) AS DECIMAL(15, 2)) AS \"avg_disc\", COUNT(*) AS \"count_order\"\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" <= DATE '1998-09-05'\r\nGROUP BY \"l_returnflag\", \"l_linestatus\"\r\nORDER BY \"l_returnflag\", \"l_linestatus\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 2301993.95, "used_rules": ["PROJECT_TO_CALC", "FILTER_REDUCE_EXPRESSIONS", "AGGREGATE_REDUCE_FUNCTIONS", "SORT_PROJECT_TRANSPOSE", "PROJECT_TO_CALC", "CALC_MERGE"], "rewrite_time": 908}
{"name": "query10_0", "input_sql": "select\n\tc_custkey,\n\tc_name,\n\tsum(l_extendedprice * (1 - l_discount)) as revenue,\n\tc_acctbal,\n\tn_name,\n\tc_address,\n\tc_phone,\n\tc_comment\nfrom\n\tcustomer,\n\torders,\n\tlineitem,\n\tnation\nwhere\n\tc_custkey = o_custkey\n\tand l_orderkey = o_orderkey\n\tand o_orderdate >= date '1993-11-01'\n\tand o_orderdate < date '1993-11-01' + interval '3' month\n\tand l_returnflag = 'R'\n\tand c_nationkey = n_nationkey\ngroup by\n\tc_custkey,\n\tc_name,\n\tc_acctbal,\n\tc_phone,\n\tn_name,\n\tc_address,\n\tc_comment\norder by\n\trevenue desc\nlimit 20;", "input_cost": 2153326.33, "output_sql": "SELECT \"t2\".\"c_custkey\", \"t2\".\"c_name\", COALESCE(SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")), 0) AS \"revenue\", \"t2\".\"c_acctbal\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_phone\", \"t2\".\"c_comment\"\r\nFROM (SELECT *\r\n        FROM (SELECT *\r\n                FROM \"customer\",\r\n                        (SELECT *\r\n                        FROM \"orders\"\r\n                        WHERE \"o_orderdate\" >= DATE '1993-11-01' AND \"o_orderdate\" < DATE '1994-02-01') AS \"t\"\r\n                WHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n                (SELECT *\r\n                FROM \"lineitem\"\r\n                WHERE \"l_returnflag\" = 'R') AS \"t1\"\r\n        WHERE \"t1\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t2\",\r\n    \"nation\"\r\nWHERE \"t2\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"t2\".\"c_custkey\", \"t2\".\"c_name\", \"t2\".\"c_acctbal\", \"t2\".\"c_phone\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_comment\"\r\nORDER BY 8 DESC\r\nFETCH NEXT 20 ROWS ONLY;", "output_cost": 1183803.58, "used_rules": ["FILTER_INTO_JOIN", "FILTER_REDUCE_EXPRESSIONS", "SORT_PROJECT_TRANSPOSE", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1764}
{"name": "query10_1", "input_sql": "select\n\tc_custkey,\n\tc_name,\n\tsum(l_extendedprice * (1 - l_discount)) as revenue,\n\tc_acctbal,\n\tn_name,\n\tc_address,\n\tc_phone,\n\tc_comment\nfrom\n\tcustomer,\n\torders,\n\tlineitem,\n\tnation\nwhere\n\tc_custkey = o_custkey\n\tand l_orderkey = o_orderkey\n\tand o_orderdate >= date '1994-08-01'\n\tand o_orderdate < date '1994-08-01' + interval '3' month\n\tand l_returnflag = 'R'\n\tand c_nationkey = n_nationkey\ngroup by\n\tc_custkey,\n\tc_name,\n\tc_acctbal,\n\tc_phone,\n\tn_name,\n\tc_address,\n\tc_comment\norder by\n\trevenue desc\nlimit 20;", "input_cost": 2154377.79, "output_sql": "SELECT \"t2\".\"c_custkey\", \"t2\".\"c_name\", COALESCE(SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")), 0) AS \"revenue\", \"t2\".\"c_acctbal\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_phone\", \"t2\".\"c_comment\"\r\nFROM (SELECT *\r\n        FROM (SELECT *\r\n                FROM \"customer\",\r\n                        (SELECT *\r\n                        FROM \"orders\"\r\n                        WHERE \"o_orderdate\" >= DATE '1994-08-01' AND \"o_orderdate\" < DATE '1994-11-01') AS \"t\"\r\n                WHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n                (SELECT *\r\n                FROM \"lineitem\"\r\n                WHERE \"l_returnflag\" = 'R') AS \"t1\"\r\n        WHERE \"t1\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t2\",\r\n    \"nation\"\r\nWHERE \"t2\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"t2\".\"c_custkey\", \"t2\".\"c_name\", \"t2\".\"c_acctbal\", \"t2\".\"c_phone\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_comment\"\r\nORDER BY 8 DESC\r\nFETCH NEXT 20 ROWS ONLY;", "output_cost": 1183840.83, "used_rules": ["FILTER_INTO_JOIN", "FILTER_REDUCE_EXPRESSIONS", "SORT_PROJECT_TRANSPOSE", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1073}
{"name": "query11_0", "input_sql": "select\n\tps_partkey,\n\tsum(ps_supplycost * ps_availqty) as \"value\"\nfrom\n\tpartsupp,\n\tsupplier,\n\tnation\nwhere\n\tps_suppkey = s_suppkey\n\tand s_nationkey = n_nationkey\n\tand n_name = 'INDIA'\ngroup by\n\tps_partkey having\n\t\tsum(ps_supplycost * ps_availqty) > (\n\t\t\tselect\n\t\t\t\tsum(ps_supplycost * ps_availqty) * 0.0000100000\n\t\t\tfrom\n\t\t\t\tpartsupp,\n\t\t\t\tsupplier,\n\t\t\t\tnation\n\t\t\twhere\n\t\t\t\tps_suppkey = s_suppkey\n\t\t\t\tand s_nationkey = n_nationkey\n\t\t\t\tand n_name = 'INDIA'\n\t\t)\norder by\n\t\"value\" desc\nlimit 1;", "input_cost": 458456.77, "output_sql": "None", "output_cost": -1, "used_rules": [], "rewrite_time": 1061}
{"name": "query11_1", "input_sql": "select\n\tps_partkey,\n\tsum(ps_supplycost * ps_availqty) as \"value\"\nfrom\n\tpartsupp,\n\tsupplier,\n\tnation\nwhere\n\tps_suppkey = s_suppkey\n\tand s_nationkey = n_nationkey\n\tand n_name = 'VIETNAM'\ngroup by\n\tps_partkey having\n\t\tsum(ps_supplycost * ps_availqty) > (\n\t\t\tselect\n\t\t\t\tsum(ps_supplycost * ps_availqty) * 0.0000100000\n\t\t\tfrom\n\t\t\t\tpartsupp,\n\t\t\t\tsupplier,\n\t\t\t\tnation\n\t\t\twhere\n\t\t\t\tps_suppkey = s_suppkey\n\t\t\t\tand s_nationkey = n_nationkey\n\t\t\t\tand n_name = 'VIETNAM'\n\t\t)\norder by\n\t\"value\" desc\nlimit 1;", "input_cost": 458456.77, "output_sql": "None", "output_cost": -1, "used_rules": [], "rewrite_time": 760}
{"name": "query12_0", "input_sql": "select\n\tl_shipmode,\n\tsum(case\n\t\twhen o_orderpriority = '1-URGENT'\n\t\t\tor o_orderpriority = '2-HIGH'\n\t\t\tthen 1\n\t\telse 0\n\tend) as high_line_count,\n\tsum(case\n\t\twhen o_orderpriority <> '1-URGENT'\n\t\t\tand o_orderpriority <> '2-HIGH'\n\t\t\tthen 1\n\t\telse 0\n\tend) as low_line_count\nfrom\n\torders,\n\tlineitem\nwhere\n\to_orderkey = l_orderkey\n\tand l_shipmode in ('SHIP', 'RAIL')\n\tand l_commitdate < l_receiptdate\n\tand l_shipdate < l_commitdate\n\tand l_receiptdate >= date '1995-01-01'\n\tand l_receiptdate < date '1995-01-01' + interval '1' year\ngroup by\n\tl_shipmode\norder by\n\tl_shipmode\nlimit 1;", "input_cost": 2179852.67, "output_sql": "SELECT \"t\".\"l_shipmode\", COALESCE(SUM(CASE WHEN CAST(\"orders\".\"o_orderpriority\" AS CHAR(8)) = '1-URGENT' OR CAST(\"orders\".\"o_orderpriority\" AS CHAR(6)) = '2-HIGH' THEN 1 ELSE 0 END), 0) AS \"high_line_count\", COALESCE(SUM(CASE WHEN CAST(\"orders\".\"o_orderpriority\" AS CHAR(8)) <> '1-URGENT' AND CAST(\"orders\".\"o_orderpriority\" AS CHAR(6)) <> '2-HIGH' THEN 1 ELSE 0 END), 0) AS \"low_line_count\"\r\nFROM \"orders\",\r\n        (SELECT *\r\n        FROM \"lineitem\"\r\n        WHERE CAST(\"l_shipmode\" AS CHAR(4)) IN ('RAIL', 'SHIP') AND \"l_commitdate\" < \"l_receiptdate\" AND \"l_shipdate\" < \"l_commitdate\" AND (\"l_receiptdate\" >= DATE '1995-01-01' AND \"l_receiptdate\" < DATE '1996-01-01')) AS \"t\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t\".\"l_orderkey\"\r\nGROUP BY \"t\".\"l_shipmode\"\r\nORDER BY \"t\".\"l_shipmode\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 2226410.33, "used_rules": ["FILTER_INTO_JOIN", "FILTER_REDUCE_EXPRESSIONS", "PROJECT_TO_CALC", "AGGREGATE_REDUCE_FUNCTIONS", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1032}
{"name": "query12_1", "input_sql": "select\n\tl_shipmode,\n\tsum(case\n\t\twhen o_orderpriority = '1-URGENT'\n\t\t\tor o_orderpriority = '2-HIGH'\n\t\t\tthen 1\n\t\telse 0\n\tend) as high_line_count,\n\tsum(case\n\t\twhen o_orderpriority <> '1-URGENT'\n\t\t\tand o_orderpriority <> '2-HIGH'\n\t\t\tthen 1\n\t\telse 0\n\tend) as low_line_count\nfrom\n\torders,\n\tlineitem\nwhere\n\to_orderkey = l_orderkey\n\tand l_shipmode in ('FOB', 'RAIL')\n\tand l_commitdate < l_receiptdate\n\tand l_shipdate < l_commitdate\n\tand l_receiptdate >= date '1996-01-01'\n\tand l_receiptdate < date '1996-01-01' + interval '1' year\ngroup by\n\tl_shipmode\norder by\n\tl_shipmode\nlimit 1;", "input_cost": 2179806.19, "output_sql": "SELECT \"t\".\"l_shipmode\", COALESCE(SUM(CASE WHEN CAST(\"orders\".\"o_orderpriority\" AS CHAR(8)) = '1-URGENT' OR CAST(\"orders\".\"o_orderpriority\" AS CHAR(6)) = '2-HIGH' THEN 1 ELSE 0 END), 0) AS \"high_line_count\", COALESCE(SUM(CASE WHEN CAST(\"orders\".\"o_orderpriority\" AS CHAR(8)) <> '1-URGENT' AND CAST(\"orders\".\"o_orderpriority\" AS CHAR(6)) <> '2-HIGH' THEN 1 ELSE 0 END), 0) AS \"low_line_count\"\r\nFROM \"orders\",\r\n        (SELECT *\r\n        FROM \"lineitem\"\r\n        WHERE (\"l_shipmode\" = 'FOB' OR \"l_shipmode\" = 'RAIL') AND \"l_commitdate\" < \"l_receiptdate\" AND \"l_shipdate\" < \"l_commitdate\" AND (\"l_receiptdate\" >= DATE '1996-01-01' AND \"l_receiptdate\" < DATE '1997-01-01')) AS \"t\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t\".\"l_orderkey\"\r\nGROUP BY \"t\".\"l_shipmode\"\r\nORDER BY \"t\".\"l_shipmode\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 2241225.57, "used_rules": ["FILTER_INTO_JOIN", "FILTER_REDUCE_EXPRESSIONS", "PROJECT_TO_CALC", "AGGREGATE_REDUCE_FUNCTIONS", "JOIN_EXTRACT_FILTER"], "rewrite_time": 828}
{"name": "query13_0", "input_sql": "select\n\tc_count,\n\tcount(*) as custdist\nfrom\n\t(\n\t\tselect\n\t\t\tc_custkey,\n\t\t\tcount(o_orderkey)\n\t\tfrom\n\t\t\tcustomer left outer join orders on\n\t\t\t\tc_custkey = o_custkey\n\t\t\t\tand o_comment not like '%pending%accounts%'\n\t\tgroup by\n\t\t\tc_custkey\n\t) as c_orders (c_custkey, c_count)\ngroup by\n\tc_count\norder by\n\tcustdist desc,\n\tc_count desc\nlimit 1;", "input_cost": 1563164.39, "output_sql": "SELECT \"t\".\"EXPR$1\", COUNT(*) AS \"custdist\"\r\nFROM (SELECT \"customer\".\"c_custkey\", COUNT(\"orders\".\"o_orderkey\") AS \"EXPR$1\"\r\n        FROM \"customer\"\r\n            LEFT JOIN \"orders\" ON \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"orders\".\"o_comment\" NOT LIKE '%pending%accounts%'\r\n        GROUP BY \"customer\".\"c_custkey\") AS \"t\"\r\nGROUP BY \"t\".\"EXPR$1\"\r\nORDER BY 2 DESC, \"t\".\"EXPR$1\" DESC\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 1563164.39, "used_rules": ["AGGREGATE_PROJECT_MERGE"], "rewrite_time": 342}
{"name": "query13_1", "input_sql": "select\n\tc_count,\n\tcount(*) as custdist\nfrom\n\t(\n\t\tselect\n\t\t\tc_custkey,\n\t\t\tcount(o_orderkey)\n\t\tfrom\n\t\t\tcustomer left outer join orders on\n\t\t\t\tc_custkey = o_custkey\n\t\t\t\tand o_comment not like '%pending%accounts%'\n\t\tgroup by\n\t\t\tc_custkey\n\t) as c_orders (c_custkey, c_count)\ngroup by\n\tc_count\norder by\n\tcustdist desc,\n\tc_count desc\nlimit 1;", "input_cost": 1563164.39, "output_sql": "SELECT \"t\".\"EXPR$1\", COUNT(*) AS \"custdist\"\r\nFROM (SELECT \"customer\".\"c_custkey\", COUNT(\"orders\".\"o_orderkey\") AS \"EXPR$1\"\r\n        FROM \"customer\"\r\n            LEFT JOIN \"orders\" ON \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"orders\".\"o_comment\" NOT LIKE '%pending%accounts%'\r\n        GROUP BY \"customer\".\"c_custkey\") AS \"t\"\r\nGROUP BY \"t\".\"EXPR$1\"\r\nORDER BY 2 DESC, \"t\".\"EXPR$1\" DESC\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 1563164.39, "used_rules": ["AGGREGATE_PROJECT_MERGE"], "rewrite_time": 287}
{"name": "query14_0", "input_sql": "select\n\t100.00 * sum(case\n\t\twhen p_type like 'PROMO%'\n\t\t\tthen l_extendedprice * (1 - l_discount)\n\t\telse 0\n\tend) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue\nfrom\n\tlineitem,\n\tpart\nwhere\n\tl_partkey = p_partkey\n\tand l_shipdate >= date '1995-10-01'\n\tand l_shipdate < date '1995-10-01' + interval '1' month\nlimit 1;", "input_cost": 1583043.25, "output_sql": "SELECT 100.00 * CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(CASE WHEN \"part\".\"p_type\" LIKE 'PROMO%' THEN \"t\".\"l_extendedprice\" * (1 - \"t\".\"l_discount\") ELSE 0 END), 0) END / CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(\"t\".\"l_extendedprice\" * (1 - \"t\".\"l_discount\")), 0) END AS \"promo_revenue\"\r\nFROM (SELECT *\r\n        FROM \"lineitem\"\r\n        WHERE \"l_shipdate\" >= DATE '1995-10-01' AND \"l_shipdate\" < DATE '1995-11-01') AS \"t\"\r\n    INNER JOIN \"part\" ON \"t\".\"l_partkey\" = \"part\".\"p_partkey\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 1583817.71, "used_rules": ["FILTER_INTO_JOIN", "FILTER_REDUCE_EXPRESSIONS", "SORT_PROJECT_TRANSPOSE", "PROJECT_TO_CALC", "AGGREGATE_REDUCE_FUNCTIONS", "SORT_PROJECT_TRANSPOSE"], "rewrite_time": 650}
{"name": "query14_1", "input_sql": "select\n\t100.00 * sum(case\n\t\twhen p_type like 'PROMO%'\n\t\t\tthen l_extendedprice * (1 - l_discount)\n\t\telse 0\n\tend) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue\nfrom\n\tlineitem,\n\tpart\nwhere\n\tl_partkey = p_partkey\n\tand l_shipdate >= date '1996-02-01'\n\tand l_shipdate < date '1996-02-01' + interval '1' month\nlimit 1;", "input_cost": 1582833.23, "output_sql": "SELECT 100.00 * CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(CASE WHEN \"part\".\"p_type\" LIKE 'PROMO%' THEN \"t\".\"l_extendedprice\" * (1 - \"t\".\"l_discount\") ELSE 0 END), 0) END / CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(\"t\".\"l_extendedprice\" * (1 - \"t\".\"l_discount\")), 0) END AS \"promo_revenue\"\r\nFROM (SELECT *\r\n        FROM \"lineitem\"\r\n        WHERE \"l_shipdate\" >= DATE '1996-02-01' AND \"l_shipdate\" < DATE '1996-03-01') AS \"t\",\r\n    \"part\"\r\nWHERE \"t\".\"l_partkey\" = \"part\".\"p_partkey\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 1583592.74, "used_rules": ["FILTER_INTO_JOIN", "FILTER_REDUCE_EXPRESSIONS", "PROJECT_TO_CALC", "AGGREGATE_REDUCE_FUNCTIONS", "JOIN_EXTRACT_FILTER"], "rewrite_time": 624}
{"name": "query15_0", "input_sql": "with revenue0 (supplier_no, total_revenue) as\n\t(select\n\t\tl_suppkey,\n\t\tsum(l_extendedprice * (1 - l_discount))\n\tfrom\n\t\tlineitem\n\twhere\n\t\tl_shipdate >= date '1993-05-01'\n\t\tand l_shipdate < date '1993-05-01' + interval '3' month\n\tgroup by\n\t\tl_suppkey)\nselect\n\ts_suppkey,\n\ts_name,\n\ts_address,\n\ts_phone,\n\ttotal_revenue\nfrom\n\tsupplier,\n\trevenue0\nwhere\n\ts_suppkey = supplier_no\n\tand total_revenue = (\n\t\tselect\n\t\t\tmax(total_revenue)\n\t\tfrom\n\t\t\trevenue0\n\t)\norder by\n\ts_suppkey\nlimit 1;", "input_cost": 1625492.32, "output_sql": "None", "output_cost": -1, "used_rules": [], "rewrite_time": 655}
{"name": "query15_1", "input_sql": "with revenue0 (supplier_no, total_revenue) as\n\t(select\n\t\tl_suppkey,\n\t\tsum(l_extendedprice * (1 - l_discount))\n\tfrom\n\t\tlineitem\n\twhere\n\t\tl_shipdate >= date '1995-12-01'\n\t\tand l_shipdate < date '1995-12-01' + interval '3' month\n\tgroup by\n\t\tl_suppkey)\nselect\n\ts_suppkey,\n\ts_name,\n\ts_address,\n\ts_phone,\n\ttotal_revenue\nfrom\n\tsupplier,\n\trevenue0\nwhere\n\ts_suppkey = supplier_no\n\tand total_revenue = (\n\t\tselect\n\t\t\tmax(total_revenue)\n\t\tfrom\n\t\t\trevenue0\n\t)\norder by\n\ts_suppkey\nlimit 1;", "input_cost": 1625052.45, "output_sql": "None", "output_cost": -1, "used_rules": [], "rewrite_time": 607}
{"name": "query16_0", "input_sql": "select\n\tp_brand,\n\tp_type,\n\tp_size,\n\tcount(distinct ps_suppkey) as supplier_cnt\nfrom\n\tpartsupp,\n\tpart\nwhere\n\tp_partkey = ps_partkey\n\tand p_brand <> 'Brand#42'\n\tand p_type not like 'MEDIUM PLATED%'\n\tand p_size in (43, 45, 15, 11, 40, 35, 28, 46)\n\tand ps_suppkey not in (\n\t\tselect\n\t\t\ts_suppkey\n\t\tfrom\n\t\t\tsupplier\n\t\twhere\n\t\t\ts_comment like '%Customer%Complaints%'\n\t)\ngroup by\n\tp_brand,\n\tp_type,\n\tp_size\norder by\n\tsupplier_cnt desc,\n\tp_brand,\n\tp_type,\n\tp_size\nlimit 1;", "input_cost": 414891.33, "output_sql": "SELECT \"t10\".\"ps_partkey\", \"t10\".\"ps_suppkey\", \"t10\".\"ps_availqty\", COUNT(\"t10\".\"ps_supplycost\") AS \"supplier_cnt\"\r\nFROM (SELECT \"t7\".\"p_brand\" AS \"ps_partkey\", \"t7\".\"p_type\" AS \"ps_suppkey\", \"t7\".\"p_size\" AS \"ps_availqty\", \"t6\".\"ps_suppkey\" AS \"ps_supplycost\"\r\n        FROM (SELECT \"partsupp\".\"ps_partkey\", \"partsupp\".\"ps_suppkey\", \"partsupp\".\"ps_availqty\", \"partsupp\".\"ps_supplycost\", \"partsupp\".\"ps_comment\"\r\n                FROM \"partsupp\"\r\n                    CROSS JOIN (SELECT COUNT(*) AS \"c\", COUNT(*) AS \"ck\"\r\n                        FROM \"supplier\"\r\n                        WHERE \"s_comment\" LIKE '%Customer%Complaints%') AS \"t1\"\r\n                    LEFT JOIN (SELECT \"s_suppkey0\", TRUE AS \"i\"\r\n                        FROM \"supplier\" AS \"supplier0\" (\"s_suppkey0\", \"s_name0\", \"s_address0\", \"s_nationkey0\", \"s_phone0\", \"s_acctbal0\", \"s_comment0\")\r\n                        WHERE \"s_comment0\" LIKE '%Customer%Complaints%'\r\n                        GROUP BY \"s_suppkey0\") AS \"t4\" ON \"partsupp\".\"ps_suppkey\" = \"t4\".\"s_suppkey0\"\r\n                WHERE \"t1\".\"c\" = 0 OR \"t4\".\"i\" IS NULL AND \"t1\".\"ck\" >= \"t1\".\"c\") AS \"t6\",\r\n                (SELECT *\r\n                FROM \"part\"\r\n                WHERE \"p_brand\" <> 'Brand#42' AND \"p_size\" IN (11, 15, 28, 35, 40, 43, 45, 46) AND \"p_type\" NOT LIKE 'MEDIUM PLATED%') AS \"t7\"\r\n        WHERE \"t7\".\"p_partkey\" = \"t6\".\"ps_partkey\"\r\n        GROUP BY \"t7\".\"p_brand\", \"t7\".\"p_type\", \"t7\".\"p_size\", \"t6\".\"ps_suppkey\") AS \"t10\"\r\nGROUP BY \"t10\".\"ps_partkey\", \"t10\".\"ps_suppkey\", \"t10\".\"ps_availqty\"\r\nORDER BY 4 DESC, \"t10\".\"ps_partkey\", \"t10\".\"ps_suppkey\", \"t10\".\"ps_availqty\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 336462.29, "used_rules": ["FILTER_INTO_JOIN", "FILTER_SUB_QUERY_TO_CORRELATE", "PROJECT_TO_CALC", "AGGREGATE_EXPAND_DISTINCT_AGGREGATES", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1327}
{"name": "query16_1", "input_sql": "select\n\tp_brand,\n\tp_type,\n\tp_size,\n\tcount(distinct ps_suppkey) as supplier_cnt\nfrom\n\tpartsupp,\n\tpart\nwhere\n\tp_partkey = ps_partkey\n\tand p_brand <> 'Brand#22'\n\tand p_type not like 'ECONOMY BRUSHED%'\n\tand p_size in (47, 16, 48, 39, 37, 28, 7, 50)\n\tand ps_suppkey not in (\n\t\tselect\n\t\t\ts_suppkey\n\t\tfrom\n\t\t\tsupplier\n\t\twhere\n\t\t\ts_comment like '%Customer%Complaints%'\n\t)\ngroup by\n\tp_brand,\n\tp_type,\n\tp_size\norder by\n\tsupplier_cnt desc,\n\tp_brand,\n\tp_type,\n\tp_size\nlimit 1;", "input_cost": 411984.38, "output_sql": "SELECT \"t10\".\"ps_partkey\", \"t10\".\"ps_suppkey\", \"t10\".\"ps_availqty\", COUNT(\"t10\".\"ps_supplycost\") AS \"supplier_cnt\"\r\nFROM (SELECT \"t7\".\"p_brand\" AS \"ps_partkey\", \"t7\".\"p_type\" AS \"ps_suppkey\", \"t7\".\"p_size\" AS \"ps_availqty\", \"t6\".\"ps_suppkey\" AS \"ps_supplycost\"\r\n        FROM (SELECT \"partsupp\".\"ps_partkey\", \"partsupp\".\"ps_suppkey\", \"partsupp\".\"ps_availqty\", \"partsupp\".\"ps_supplycost\", \"partsupp\".\"ps_comment\"\r\n                FROM \"partsupp\"\r\n                    CROSS JOIN (SELECT COUNT(*) AS \"c\", COUNT(*) AS \"ck\"\r\n                        FROM \"supplier\"\r\n                        WHERE \"s_comment\" LIKE '%Customer%Complaints%') AS \"t1\"\r\n                    LEFT JOIN (SELECT \"s_suppkey0\", TRUE AS \"i\"\r\n                        FROM \"supplier\" AS \"supplier0\" (\"s_suppkey0\", \"s_name0\", \"s_address0\", \"s_nationkey0\", \"s_phone0\", \"s_acctbal0\", \"s_comment0\")\r\n                        WHERE \"s_comment0\" LIKE '%Customer%Complaints%'\r\n                        GROUP BY \"s_suppkey0\") AS \"t4\" ON \"partsupp\".\"ps_suppkey\" = \"t4\".\"s_suppkey0\"\r\n                WHERE \"t1\".\"c\" = 0 OR \"t4\".\"i\" IS NULL AND \"t1\".\"ck\" >= \"t1\".\"c\") AS \"t6\",\r\n                (SELECT *\r\n                FROM \"part\"\r\n                WHERE \"p_brand\" <> 'Brand#22' AND \"p_size\" IN (7, 16, 28, 37, 39, 47, 48, 50) AND \"p_type\" NOT LIKE 'ECONOMY BRUSHED%') AS \"t7\"\r\n        WHERE \"t7\".\"p_partkey\" = \"t6\".\"ps_partkey\"\r\n        GROUP BY \"t7\".\"p_brand\", \"t7\".\"p_type\", \"t7\".\"p_size\", \"t6\".\"ps_suppkey\") AS \"t10\"\r\nGROUP BY \"t10\".\"ps_partkey\", \"t10\".\"ps_suppkey\", \"t10\".\"ps_availqty\"\r\nORDER BY 4 DESC, \"t10\".\"ps_partkey\", \"t10\".\"ps_suppkey\", \"t10\".\"ps_availqty\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 335954.02, "used_rules": ["FILTER_INTO_JOIN", "FILTER_SUB_QUERY_TO_CORRELATE", "PROJECT_TO_CALC", "AGGREGATE_EXPAND_DISTINCT_AGGREGATES", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1310}
{"name": "query17_0", "input_sql": "select\n\tsum(l_extendedprice) / 7.0 as avg_yearly\nfrom\n\tlineitem,\n\tpart\nwhere\n\tp_partkey = l_partkey\n\tand p_brand = 'Brand#23'\n\tand p_container = 'WRAP BAG'\n\tand l_quantity < (\n\t\tselect\n\t\t\t0.2 * avg(l_quantity)\n\t\tfrom\n\t\t\tlineitem\n\t\twhere\n\t\t\tl_partkey = p_partkey\n\t)\nlimit 1;", "input_cost": 122645346417.46, "output_sql": "SELECT CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(\"t0\".\"l_extendedprice\"), 0) END / 7.0 AS \"$f0\"\r\nFROM (SELECT *\r\n        FROM \"lineitem\",\r\n                (SELECT *\r\n                FROM \"part\"\r\n                WHERE \"p_brand\" = 'Brand#23' AND \"p_container\" = 'WRAP BAG') AS \"t\"\r\n        WHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\") AS \"t0\",\r\n        (SELECT \"l_partkey0\", CAST(CAST(COALESCE(SUM(\"l_quantity0\"), 0) AS DECIMAL(15, 2)) / COUNT(*) AS DECIMAL(15, 2)) AS \"$f1\"\r\n        FROM \"lineitem\" AS \"lineitem0\" (\"l_orderkey0\", \"l_partkey0\", \"l_suppkey0\", \"l_linenumber0\", \"l_quantity0\", \"l_extendedprice0\", \"l_discount0\", \"l_tax0\", \"l_returnflag0\", \"l_linestatus0\", \"l_shipdate0\", \"l_commitdate0\", \"l_receiptdate0\", \"l_shipinstruct0\", \"l_shipmode0\", \"l_comment0\")\r\n        GROUP BY \"l_partkey0\") AS \"t2\"\r\nWHERE \"t0\".\"p_partkey\" = \"t2\".\"l_partkey0\" AND \"t0\".\"l_quantity\" < 0.2 * \"t2\".\"$f1\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 5828283.07, "used_rules": ["FILTER_SUB_QUERY_TO_CORRELATE", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "CALC_MERGE", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1331}
{"name": "query17_1", "input_sql": "select\n\tsum(l_extendedprice) / 7.0 as avg_yearly\nfrom\n\tlineitem,\n\tpart\nwhere\n\tp_partkey = l_partkey\n\tand p_brand = 'Brand#25'\n\tand p_container = 'WRAP PACK'\n\tand l_quantity < (\n\t\tselect\n\t\t\t0.2 * avg(l_quantity)\n\t\tfrom\n\t\t\tlineitem\n\t\twhere\n\t\t\tl_partkey = p_partkey\n\t)\nlimit 1;", "input_cost": 111456067891.46, "output_sql": "SELECT CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(\"lineitem\".\"l_extendedprice\"), 0) END / 7.0 AS \"$f0\"\r\nFROM \"lineitem\"\r\n    INNER JOIN (SELECT *\r\n        FROM \"part\"\r\n        WHERE \"p_brand\" = 'Brand#25' AND \"p_container\" = 'WRAP PACK') AS \"t\" ON \"lineitem\".\"l_partkey\" = \"t\".\"p_partkey\"\r\n    INNER JOIN (SELECT \"l_partkey0\", CAST(CAST(COALESCE(SUM(\"l_quantity0\"), 0) AS DECIMAL(15, 2)) / COUNT(*) AS DECIMAL(15, 2)) AS \"$f1\"\r\n        FROM \"lineitem\" AS \"lineitem0\" (\"l_orderkey0\", \"l_partkey0\", \"l_suppkey0\", \"l_linenumber0\", \"l_quantity0\", \"l_extendedprice0\", \"l_discount0\", \"l_tax0\", \"l_returnflag0\", \"l_linestatus0\", \"l_shipdate0\", \"l_commitdate0\", \"l_receiptdate0\", \"l_shipinstruct0\", \"l_shipmode0\", \"l_comment0\")\r\n        GROUP BY \"l_partkey0\") AS \"t1\" ON \"t\".\"p_partkey\" = \"t1\".\"l_partkey0\" AND \"lineitem\".\"l_quantity\" < 0.2 * \"t1\".\"$f1\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 5827583.72, "used_rules": ["FILTER_SUB_QUERY_TO_CORRELATE", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "CALC_MERGE"], "rewrite_time": 1052}
{"name": "query18_0", "input_sql": "select\n\tc_name,\n\tc_custkey,\n\to_orderkey,\n\to_orderdate,\n\to_totalprice,\n\tsum(l_quantity)\nfrom\n\tcustomer,\n\torders,\n\tlineitem\nwhere\n\to_orderkey in (\n\t\tselect\n\t\t\tl_orderkey\n\t\tfrom\n\t\t\tlineitem\n\t\tgroup by\n\t\t\tl_orderkey having\n\t\t\t\tsum(l_quantity) > 313\n\t)\n\tand c_custkey = o_custkey\n\tand o_orderkey = l_orderkey\ngroup by\n\tc_name,\n\tc_custkey,\n\to_orderkey,\n\to_orderdate,\n\to_totalprice\norder by\n\to_totalprice desc,\n\to_orderdate\nlimit 100;", "input_cost": 6587093.57, "output_sql": "SELECT \"t7\".\"c_name\" AS \"c_custkey\", \"t7\".\"c_custkey\" AS \"c_name\", \"t7\".\"o_orderkey\", \"t7\".\"o_orderdate\" AS \"o_totalprice\", \"t7\".\"o_totalprice\" AS \"o_orderdate\", \"t7\".\"$f8\" * \"t8\".\"EXPR$5\" AS \"$f8\"\r\nFROM (SELECT \"t\".\"c_custkey\", \"t\".\"c_name\", \"t5\".\"o_orderkey\", \"t5\".\"o_totalprice\", \"t5\".\"o_orderdate\", \"t\".\"$f2\" * \"t5\".\"$f4\" AS \"$f8\"\r\n        FROM (SELECT \"c_custkey\", \"c_name\", COUNT(*) AS \"$f2\"\r\n                FROM \"customer\"\r\n                GROUP BY \"c_custkey\", \"c_name\") AS \"t\",\r\n                (SELECT \"t0\".\"o_orderkey\", \"t0\".\"o_custkey\", \"t0\".\"o_totalprice\", \"t0\".\"o_orderdate\", \"t0\".\"$f4\"\r\n                FROM (SELECT \"o_orderkey\", \"o_custkey\", \"o_totalprice\", \"o_orderdate\", COUNT(*) AS \"$f4\"\r\n                        FROM \"orders\"\r\n                        GROUP BY \"o_orderkey\", \"o_custkey\", \"o_totalprice\", \"o_orderdate\") AS \"t0\",\r\n                        (SELECT \"l_orderkey\"\r\n                        FROM \"lineitem\"\r\n                        GROUP BY \"l_orderkey\"\r\n                        HAVING COALESCE(SUM(\"l_quantity\"), 0) > 313) AS \"t3\"\r\n                WHERE \"t0\".\"o_orderkey\" = \"t3\".\"l_orderkey\") AS \"t5\"\r\n        WHERE \"t\".\"c_custkey\" = \"t5\".\"o_custkey\") AS \"t7\",\r\n        (SELECT \"l_orderkey0\", COALESCE(SUM(\"l_quantity0\"), 0) AS \"EXPR$5\"\r\n        FROM \"lineitem\" AS \"lineitem0\" (\"l_orderkey0\", \"l_partkey0\", \"l_suppkey0\", \"l_linenumber0\", \"l_quantity0\", \"l_extendedprice0\", \"l_discount0\", \"l_tax0\", \"l_returnflag0\", \"l_linestatus0\", \"l_shipdate0\", \"l_commitdate0\", \"l_receiptdate0\", \"l_shipinstruct0\", \"l_shipmode0\", \"l_comment0\")\r\n        GROUP BY \"l_orderkey0\") AS \"t8\"\r\nWHERE \"t7\".\"o_orderkey\" = \"t8\".\"l_orderkey0\"\r\nORDER BY \"t7\".\"o_totalprice\" DESC, \"t7\".\"o_orderdate\"\r\nFETCH NEXT 100 ROWS ONLY;", "output_cost": 6842789160.18, "used_rules": ["FILTER_INTO_JOIN", "FILTER_SUB_QUERY_TO_CORRELATE", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_REDUCE_FUNCTIONS", "AGGREGATE_JOIN_TRANSPOSE_EXTENDED", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_JOIN_TRANSPOSE_EXTENDED", "PROJECT_TO_CALC", "CALC_MERGE", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1285}
{"name": "query18_1", "input_sql": "select\n\tc_name,\n\tc_custkey,\n\to_orderkey,\n\to_orderdate,\n\to_totalprice,\n\tsum(l_quantity)\nfrom\n\tcustomer,\n\torders,\n\tlineitem\nwhere\n\to_orderkey in (\n\t\tselect\n\t\t\tl_orderkey\n\t\tfrom\n\t\t\tlineitem\n\t\tgroup by\n\t\t\tl_orderkey having\n\t\t\t\tsum(l_quantity) > 315\n\t)\n\tand c_custkey = o_custkey\n\tand o_orderkey = l_orderkey\ngroup by\n\tc_name,\n\tc_custkey,\n\to_orderkey,\n\to_orderdate,\n\to_totalprice\norder by\n\to_totalprice desc,\n\to_orderdate\nlimit 100;", "input_cost": 6587093.57, "output_sql": "SELECT \"t7\".\"c_name\" AS \"c_custkey\", \"t7\".\"c_custkey\" AS \"c_name\", \"t7\".\"o_orderkey\", \"t7\".\"o_orderdate\" AS \"o_totalprice\", \"t7\".\"o_totalprice\" AS \"o_orderdate\", \"t7\".\"$f8\" * \"t8\".\"EXPR$5\" AS \"$f8\"\r\nFROM (SELECT \"t\".\"c_custkey\", \"t\".\"c_name\", \"t5\".\"o_orderkey\", \"t5\".\"o_totalprice\", \"t5\".\"o_orderdate\", \"t\".\"$f2\" * \"t5\".\"$f4\" AS \"$f8\"\r\n        FROM (SELECT \"c_custkey\", \"c_name\", COUNT(*) AS \"$f2\"\r\n                FROM \"customer\"\r\n                GROUP BY \"c_custkey\", \"c_name\") AS \"t\",\r\n                (SELECT \"t0\".\"o_orderkey\", \"t0\".\"o_custkey\", \"t0\".\"o_totalprice\", \"t0\".\"o_orderdate\", \"t0\".\"$f4\"\r\n                FROM (SELECT \"o_orderkey\", \"o_custkey\", \"o_totalprice\", \"o_orderdate\", COUNT(*) AS \"$f4\"\r\n                        FROM \"orders\"\r\n                        GROUP BY \"o_orderkey\", \"o_custkey\", \"o_totalprice\", \"o_orderdate\") AS \"t0\",\r\n                        (SELECT \"l_orderkey\"\r\n                        FROM \"lineitem\"\r\n                        GROUP BY \"l_orderkey\"\r\n                        HAVING COALESCE(SUM(\"l_quantity\"), 0) > 315) AS \"t3\"\r\n                WHERE \"t0\".\"o_orderkey\" = \"t3\".\"l_orderkey\") AS \"t5\"\r\n        WHERE \"t\".\"c_custkey\" = \"t5\".\"o_custkey\") AS \"t7\",\r\n        (SELECT \"l_orderkey0\", COALESCE(SUM(\"l_quantity0\"), 0) AS \"EXPR$5\"\r\n        FROM \"lineitem\" AS \"lineitem0\" (\"l_orderkey0\", \"l_partkey0\", \"l_suppkey0\", \"l_linenumber0\", \"l_quantity0\", \"l_extendedprice0\", \"l_discount0\", \"l_tax0\", \"l_returnflag0\", \"l_linestatus0\", \"l_shipdate0\", \"l_commitdate0\", \"l_receiptdate0\", \"l_shipinstruct0\", \"l_shipmode0\", \"l_comment0\")\r\n        GROUP BY \"l_orderkey0\") AS \"t8\"\r\nWHERE \"t7\".\"o_orderkey\" = \"t8\".\"l_orderkey0\"\r\nORDER BY \"t7\".\"o_totalprice\" DESC, \"t7\".\"o_orderdate\"\r\nFETCH NEXT 100 ROWS ONLY;", "output_cost": 6842789160.18, "used_rules": ["FILTER_INTO_JOIN", "FILTER_SUB_QUERY_TO_CORRELATE", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_REDUCE_FUNCTIONS", "AGGREGATE_JOIN_TRANSPOSE_EXTENDED", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_JOIN_TRANSPOSE_EXTENDED", "PROJECT_TO_CALC", "CALC_MERGE", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1077}
{"name": "query19_0", "input_sql": "select\n\tsum(l_extendedprice* (1 - l_discount)) as revenue\nfrom\n\tlineitem,\n\tpart\nwhere\n\t(\n\t\tp_partkey = l_partkey\n\t\tand p_brand = 'Brand#55'\n\t\tand p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')\n\t\tand l_quantity >= 5 and l_quantity <= 5 + 10\n\t\tand p_size between 1 and 5\n\t\tand l_shipmode in ('AIR', 'AIR REG')\n\t\tand l_shipinstruct = 'DELIVER IN PERSON'\n\t)\n\tor\n\t(\n\t\tp_partkey = l_partkey\n\t\tand p_brand = 'Brand#21'\n\t\tand p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')\n\t\tand l_quantity >= 19 and l_quantity <= 19 + 10\n\t\tand p_size between 1 and 10\n\t\tand l_shipmode in ('AIR', 'AIR REG')\n\t\tand l_shipinstruct = 'DELIVER IN PERSON'\n\t)\n\tor\n\t(\n\t\tp_partkey = l_partkey\n\t\tand p_brand = 'Brand#44'\n\t\tand p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')\n\t\tand l_quantity >= 29 and l_quantity <= 29 + 10\n\t\tand p_size between 1 and 15\n\t\tand l_shipmode in ('AIR', 'AIR REG')\n\t\tand l_shipinstruct = 'DELIVER IN PERSON'\n\t)\nlimit 1;", "input_cost": 1954100.08, "output_sql": "SELECT CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")), 0) END AS \"revenue\"\r\nFROM \"lineitem\",\r\n    \"part\"\r\nWHERE \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND (\"part\".\"p_brand\" = 'Brand#55' AND (CAST(\"part\".\"p_container\" AS CHAR(7)) IN ('SM CASE', 'SM PACK') OR CAST(\"part\".\"p_container\" AS CHAR(6)) IN ('SM BOX', 'SM PKG'))) AND (\"lineitem\".\"l_quantity\" >= 5 AND \"lineitem\".\"l_quantity\" <= 15 AND (\"part\".\"p_size\" >= 1 AND \"part\".\"p_size\" <= 5) AND ((\"lineitem\".\"l_shipmode\" = 'AIR' OR \"lineitem\".\"l_shipmode\" = 'AIR REG') AND \"lineitem\".\"l_shipinstruct\" = 'DELIVER IN PERSON')) OR \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND (\"part\".\"p_brand\" = 'Brand#21' AND (CAST(\"part\".\"p_container\" AS CHAR(7)) IN ('MED BAG', 'MED BOX', 'MED PKG') OR \"part\".\"p_container\" = 'MED PACK')) AND (\"lineitem\".\"l_quantity\" >= 19 AND \"lineitem\".\"l_quantity\" <= 29 AND (\"part\".\"p_size\" >= 1 AND \"part\".\"p_size\" <= 10) AND ((\"lineitem\".\"l_shipmode\" = 'AIR' OR \"lineitem\".\"l_shipmode\" = 'AIR REG') AND \"lineitem\".\"l_shipinstruct\" = 'DELIVER IN PERSON')) OR \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND (\"part\".\"p_brand\" = 'Brand#44' AND (CAST(\"part\".\"p_container\" AS CHAR(7)) IN ('LG CASE', 'LG PACK') OR CAST(\"part\".\"p_container\" AS CHAR(6)) IN ('LG BOX', 'LG PKG'))) AND (\"lineitem\".\"l_quantity\" >= 29 AND \"lineitem\".\"l_quantity\" <= 39 AND (\"part\".\"p_size\" >= 1 AND \"part\".\"p_size\" <= 15) AND ((\"lineitem\".\"l_shipmode\" = 'AIR' OR \"lineitem\".\"l_shipmode\" = 'AIR REG') AND \"lineitem\".\"l_shipinstruct\" = 'DELIVER IN PERSON'))\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 2027997.21, "used_rules": ["FILTER_INTO_JOIN", "PROJECT_TO_CALC", "JOIN_REDUCE_EXPRESSIONS", "AGGREGATE_REDUCE_FUNCTIONS", "SORT_PROJECT_TRANSPOSE", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1225}
{"name": "query19_1", "input_sql": "select\n\tsum(l_extendedprice* (1 - l_discount)) as revenue\nfrom\n\tlineitem,\n\tpart\nwhere\n\t(\n\t\tp_partkey = l_partkey\n\t\tand p_brand = 'Brand#52'\n\t\tand p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')\n\t\tand l_quantity >= 1 and l_quantity <= 1 + 10\n\t\tand p_size between 1 and 5\n\t\tand l_shipmode in ('AIR', 'AIR REG')\n\t\tand l_shipinstruct = 'DELIVER IN PERSON'\n\t)\n\tor\n\t(\n\t\tp_partkey = l_partkey\n\t\tand p_brand = 'Brand#54'\n\t\tand p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')\n\t\tand l_quantity >= 20 and l_quantity <= 20 + 10\n\t\tand p_size between 1 and 10\n\t\tand l_shipmode in ('AIR', 'AIR REG')\n\t\tand l_shipinstruct = 'DELIVER IN PERSON'\n\t)\n\tor\n\t(\n\t\tp_partkey = l_partkey\n\t\tand p_brand = 'Brand#43'\n\t\tand p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')\n\t\tand l_quantity >= 25 and l_quantity <= 25 + 10\n\t\tand p_size between 1 and 15\n\t\tand l_shipmode in ('AIR', 'AIR REG')\n\t\tand l_shipinstruct = 'DELIVER IN PERSON'\n\t)\nlimit 1;", "input_cost": 1954102.53, "output_sql": "SELECT CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")), 0) END AS \"revenue\"\r\nFROM \"lineitem\"\r\n    INNER JOIN \"part\" ON \"lineitem\".\"l_partkey\" = \"part\".\"p_partkey\" AND (\"part\".\"p_brand\" = 'Brand#52' AND (CAST(\"part\".\"p_container\" AS CHAR(7)) IN ('SM CASE', 'SM PACK') OR CAST(\"part\".\"p_container\" AS CHAR(6)) IN ('SM BOX', 'SM PKG'))) AND (\"lineitem\".\"l_quantity\" >= 1 AND \"lineitem\".\"l_quantity\" <= 11 AND (\"part\".\"p_size\" >= 1 AND \"part\".\"p_size\" <= 5) AND ((\"lineitem\".\"l_shipmode\" = 'AIR' OR \"lineitem\".\"l_shipmode\" = 'AIR REG') AND \"lineitem\".\"l_shipinstruct\" = 'DELIVER IN PERSON')) OR \"lineitem\".\"l_partkey\" = \"part\".\"p_partkey\" AND (\"part\".\"p_brand\" = 'Brand#54' AND (CAST(\"part\".\"p_container\" AS CHAR(7)) IN ('MED BAG', 'MED BOX', 'MED PKG') OR \"part\".\"p_container\" = 'MED PACK')) AND (\"lineitem\".\"l_quantity\" >= 20 AND \"lineitem\".\"l_quantity\" <= 30 AND (\"part\".\"p_size\" >= 1 AND \"part\".\"p_size\" <= 10) AND ((\"lineitem\".\"l_shipmode\" = 'AIR' OR \"lineitem\".\"l_shipmode\" = 'AIR REG') AND \"lineitem\".\"l_shipinstruct\" = 'DELIVER IN PERSON')) OR \"lineitem\".\"l_partkey\" = \"part\".\"p_partkey\" AND (\"part\".\"p_brand\" = 'Brand#43' AND (CAST(\"part\".\"p_container\" AS CHAR(7)) IN ('LG CASE', 'LG PACK') OR CAST(\"part\".\"p_container\" AS CHAR(6)) IN ('LG BOX', 'LG PKG'))) AND (\"lineitem\".\"l_quantity\" >= 25 AND \"lineitem\".\"l_quantity\" <= 35 AND (\"part\".\"p_size\" >= 1 AND \"part\".\"p_size\" <= 15) AND ((\"lineitem\".\"l_shipmode\" = 'AIR' OR \"lineitem\".\"l_shipmode\" = 'AIR REG') AND \"lineitem\".\"l_shipinstruct\" = 'DELIVER IN PERSON'))\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 2027998.43, "used_rules": ["FILTER_INTO_JOIN", "PROJECT_TO_CALC", "JOIN_REDUCE_EXPRESSIONS", "AGGREGATE_REDUCE_FUNCTIONS", "SORT_PROJECT_TRANSPOSE"], "rewrite_time": 971}
{"name": "query2_0", "input_sql": "select\n\ts_acctbal,\n\ts_name,\n\tn_name,\n\tp_partkey,\n\tp_mfgr,\n\ts_address,\n\ts_phone,\n\ts_comment\nfrom\n\tpart,\n\tsupplier,\n\tpartsupp,\n\tnation,\n\tregion\nwhere\n\tp_partkey = ps_partkey\n\tand s_suppkey = ps_suppkey\n\tand p_size = 7\n\tand p_type like '%COPPER'\n\tand s_nationkey = n_nationkey\n\tand n_regionkey = r_regionkey\n\tand r_name = 'MIDDLE EAST'\n\tand ps_supplycost = (\n\t\tselect\n\t\t\tmin(ps_supplycost)\n\t\tfrom\n\t\t\tpartsupp,\n\t\t\tsupplier,\n\t\t\tnation,\n\t\t\tregion\n\t\twhere\n\t\t\tp_partkey = ps_partkey\n\t\t\tand s_suppkey = ps_suppkey\n\t\t\tand s_nationkey = n_nationkey\n\t\t\tand n_regionkey = r_regionkey\n\t\t\tand r_name = 'MIDDLE EAST'\n\t)\norder by\n\ts_acctbal desc,\n\tn_name,\n\ts_name,\n\tp_partkey\nlimit 100;", "input_cost": 1034476637.19, "output_sql": "SELECT \"t17\".\"s_acctbal\", \"t17\".\"s_name\", \"t17\".\"n_name\", \"t17\".\"p_partkey\", \"t17\".\"p_mfgr\", \"t17\".\"s_address\", \"t17\".\"s_phone\", \"t17\".\"s_comment\"\r\nFROM (SELECT \"t3\".\"p_partkey\", \"t3\".\"p_name\", \"t3\".\"p_mfgr\", \"t3\".\"p_brand\", \"t3\".\"p_type\", \"t3\".\"p_size\", \"t3\".\"p_container\", \"t3\".\"p_retailprice\", \"t3\".\"p_comment\", \"t3\".\"s_suppkey\", \"t3\".\"s_name\", \"t3\".\"s_address\", \"t3\".\"s_nationkey\", \"t3\".\"s_phone\", \"t3\".\"s_acctbal\", \"t3\".\"s_comment\", \"t3\".\"ps_partkey\", \"t3\".\"ps_suppkey\", \"t3\".\"ps_availqty\", \"t3\".\"ps_supplycost\", \"t3\".\"ps_comment\", \"t3\".\"n_nationkey\", \"t3\".\"n_name\", \"t3\".\"n_regionkey\", \"t3\".\"n_comment\", \"t3\".\"r_regionkey\", \"t3\".\"r_name\", \"t3\".\"r_comment\", CAST(\"t14\".\"ps_partkey0\" AS INTEGER) AS \"ps_partkey00\", CAST(\"t14\".\"EXPR$0\" AS DECIMAL(15, 2)) AS \"EXPR$0\"\r\n        FROM (SELECT *\r\n                FROM (SELECT *\r\n                        FROM (SELECT *\r\n                                FROM (SELECT *\r\n                                        FROM \"part\"\r\n                                        WHERE \"p_size\" = 7 AND \"p_type\" LIKE '%COPPER') AS \"t\",\r\n                                    \"supplier\",\r\n                                    \"partsupp\"\r\n                                WHERE \"t\".\"p_partkey\" = \"partsupp\".\"ps_partkey\" AND \"supplier\".\"s_suppkey\" = \"partsupp\".\"ps_suppkey\") AS \"t0\",\r\n                            \"nation\"\r\n                        WHERE \"t0\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t1\",\r\n                        (SELECT *\r\n                        FROM \"region\"\r\n                        WHERE \"r_name\" = 'MIDDLE EAST') AS \"t2\"\r\n                WHERE \"t1\".\"n_regionkey\" = \"t2\".\"r_regionkey\") AS \"t3\",\r\n                (SELECT \"t10\".\"ps_partkey0\", MIN(\"t10\".\"EXPR$0\") AS \"EXPR$0\"\r\n                FROM (SELECT \"t7\".\"ps_partkey0\", \"t8\".\"n_regionkey0\", MIN(\"t7\".\"EXPR$0\") AS \"EXPR$0\"\r\n                        FROM (SELECT \"t4\".\"ps_partkey0\", \"t5\".\"s_nationkey0\", MIN(\"t4\".\"EXPR$0\") AS \"EXPR$0\"\r\n                                FROM (SELECT \"ps_partkey0\", \"ps_suppkey0\", MIN(\"ps_supplycost0\") AS \"EXPR$0\"\r\n                                        FROM \"partsupp\" AS \"partsupp0\" (\"ps_partkey0\", \"ps_suppkey0\", \"ps_availqty0\", \"ps_supplycost0\", \"ps_comment0\")\r\n                                        GROUP BY \"ps_partkey0\", \"ps_suppkey0\") AS \"t4\",\r\n                                        (SELECT \"s_suppkey0\", \"s_nationkey0\"\r\n                                        FROM \"supplier\" AS \"supplier0\" (\"s_suppkey0\", \"s_name0\", \"s_address0\", \"s_nationkey0\", \"s_phone0\", \"s_acctbal0\", \"s_comment0\")\r\n                                        GROUP BY \"s_suppkey0\", \"s_nationkey0\") AS \"t5\"\r\n                                WHERE \"t5\".\"s_suppkey0\" = \"t4\".\"ps_suppkey0\"\r\n                                GROUP BY \"t4\".\"ps_partkey0\", \"t5\".\"s_nationkey0\") AS \"t7\",\r\n                                (SELECT \"n_nationkey0\", \"n_regionkey0\"\r\n                                FROM \"nation\" AS \"nation0\" (\"n_nationkey0\", \"n_name0\", \"n_regionkey0\", \"n_comment0\")\r\n                                GROUP BY \"n_nationkey0\", \"n_regionkey0\") AS \"t8\"\r\n                        WHERE \"t7\".\"s_nationkey0\" = \"t8\".\"n_nationkey0\"\r\n                        GROUP BY \"t7\".\"ps_partkey0\", \"t8\".\"n_regionkey0\") AS \"t10\",\r\n                        (SELECT \"r_regionkey0\"\r\n                        FROM \"region\" AS \"region0\" (\"r_regionkey0\", \"r_name0\", \"r_comment0\")\r\n                        WHERE \"r_name0\" = 'MIDDLE EAST'\r\n                        GROUP BY \"r_regionkey0\") AS \"t12\"\r\n                WHERE \"t10\".\"n_regionkey0\" = \"t12\".\"r_regionkey0\"\r\n                GROUP BY \"t10\".\"ps_partkey0\") AS \"t14\"\r\n        WHERE \"t3\".\"p_partkey\" = \"t14\".\"ps_partkey0\" AND \"t3\".\"ps_supplycost\" = \"t14\".\"EXPR$0\"\r\n        ORDER BY \"t3\".\"s_acctbal\" DESC, \"t3\".\"n_name\", \"t3\".\"s_name\", \"t3\".\"p_partkey\"\r\n        FETCH NEXT 100 ROWS ONLY) AS \"t17\";", "output_cost": 10224743.15, "used_rules": ["FILTER_SUB_QUERY_TO_CORRELATE", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_JOIN_TRANSPOSE_EXTENDED", "SORT_PROJECT_TRANSPOSE", "JOIN_EXTRACT_FILTER"], "rewrite_time": 2392}
{"name": "query2_1", "input_sql": "select\n\ts_acctbal,\n\ts_name,\n\tn_name,\n\tp_partkey,\n\tp_mfgr,\n\ts_address,\n\ts_phone,\n\ts_comment\nfrom\n\tpart,\n\tsupplier,\n\tpartsupp,\n\tnation,\n\tregion\nwhere\n\tp_partkey = ps_partkey\n\tand s_suppkey = ps_suppkey\n\tand p_size = 45\n\tand p_type like '%STEEL'\n\tand s_nationkey = n_nationkey\n\tand n_regionkey = r_regionkey\n\tand r_name = 'ASIA'\n\tand ps_supplycost = (\n\t\tselect\n\t\t\tmin(ps_supplycost)\n\t\tfrom\n\t\t\tpartsupp,\n\t\t\tsupplier,\n\t\t\tnation,\n\t\t\tregion\n\t\twhere\n\t\t\tp_partkey = ps_partkey\n\t\t\tand s_suppkey = ps_suppkey\n\t\t\tand s_nationkey = n_nationkey\n\t\t\tand n_regionkey = r_regionkey\n\t\t\tand r_name = 'ASIA'\n\t)\norder by\n\ts_acctbal desc,\n\tn_name,\n\ts_name,\n\tp_partkey\nlimit 100;", "input_cost": 1095548135.13, "output_sql": "SELECT \"supplier\".\"s_acctbal\" AS \"p_partkey\", \"supplier\".\"s_name\" AS \"p_name\", \"nation\".\"n_name\" AS \"p_mfgr\", \"t\".\"p_partkey\" AS \"p_brand\", \"t\".\"p_mfgr\" AS \"p_type\", \"supplier\".\"s_address\" AS \"p_size\", \"supplier\".\"s_phone\" AS \"p_container\", \"supplier\".\"s_comment\" AS \"p_retailprice\"\r\nFROM (SELECT *\r\n        FROM \"part\"\r\n        WHERE \"p_size\" = 45 AND \"p_type\" LIKE '%STEEL') AS \"t\"\r\n    CROSS JOIN \"supplier\"\r\n    INNER JOIN \"partsupp\" ON \"t\".\"p_partkey\" = \"partsupp\".\"ps_partkey\" AND \"supplier\".\"s_suppkey\" = \"partsupp\".\"ps_suppkey\"\r\n    INNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\n    INNER JOIN (SELECT *\r\n        FROM \"region\"\r\n        WHERE \"r_name\" = 'ASIA') AS \"t0\" ON \"nation\".\"n_regionkey\" = \"t0\".\"r_regionkey\"\r\n    INNER JOIN (SELECT \"t5\".\"ps_partkey0\", MIN(\"t5\".\"EXPR$0\") AS \"EXPR$0\"\r\n        FROM (SELECT \"t3\".\"ps_partkey0\", \"t4\".\"n_regionkey0\", MIN(\"t3\".\"EXPR$0\") AS \"EXPR$0\"\r\n                FROM (SELECT \"t1\".\"ps_partkey0\", \"t2\".\"s_nationkey0\", MIN(\"t1\".\"EXPR$0\") AS \"EXPR$0\"\r\n                        FROM (SELECT \"ps_partkey0\", \"ps_suppkey0\", MIN(\"ps_supplycost0\") AS \"EXPR$0\"\r\n                                FROM \"partsupp\" AS \"partsupp0\" (\"ps_partkey0\", \"ps_suppkey0\", \"ps_availqty0\", \"ps_supplycost0\", \"ps_comment0\")\r\n                                GROUP BY \"ps_partkey0\", \"ps_suppkey0\") AS \"t1\"\r\n                            INNER JOIN (SELECT \"s_suppkey0\", \"s_nationkey0\"\r\n                                FROM \"supplier\" AS \"supplier0\" (\"s_suppkey0\", \"s_name0\", \"s_address0\", \"s_nationkey0\", \"s_phone0\", \"s_acctbal0\", \"s_comment0\")\r\n                                GROUP BY \"s_suppkey0\", \"s_nationkey0\") AS \"t2\" ON \"t1\".\"ps_suppkey0\" = \"t2\".\"s_suppkey0\"\r\n                        GROUP BY \"t1\".\"ps_partkey0\", \"t2\".\"s_nationkey0\") AS \"t3\"\r\n                    INNER JOIN (SELECT \"n_nationkey0\", \"n_regionkey0\"\r\n                        FROM \"nation\" AS \"nation0\" (\"n_nationkey0\", \"n_name0\", \"n_regionkey0\", \"n_comment0\")\r\n                        GROUP BY \"n_nationkey0\", \"n_regionkey0\") AS \"t4\" ON \"t3\".\"s_nationkey0\" = \"t4\".\"n_nationkey0\"\r\n                GROUP BY \"t3\".\"ps_partkey0\", \"t4\".\"n_regionkey0\") AS \"t5\"\r\n            INNER JOIN (SELECT \"r_regionkey0\"\r\n                FROM \"region\" AS \"region0\" (\"r_regionkey0\", \"r_name0\", \"r_comment0\")\r\n                WHERE \"r_name0\" = 'ASIA'\r\n                GROUP BY \"r_regionkey0\") AS \"t7\" ON \"t5\".\"n_regionkey0\" = \"t7\".\"r_regionkey0\"\r\n        GROUP BY \"t5\".\"ps_partkey0\") AS \"t8\" ON \"t\".\"p_partkey\" = \"t8\".\"ps_partkey0\" AND \"partsupp\".\"ps_supplycost\" = \"t8\".\"EXPR$0\"\r\nORDER BY \"supplier\".\"s_acctbal\" DESC, \"nation\".\"n_name\", \"supplier\".\"s_name\", \"t\".\"p_partkey\"\r\nFETCH NEXT 100 ROWS ONLY;", "output_cost": 10224782.3, "used_rules": ["FILTER_SUB_QUERY_TO_CORRELATE", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_JOIN_TRANSPOSE_EXTENDED", "SORT_PROJECT_TRANSPOSE", "PROJECT_REDUCE_EXPRESSIONS", "PROJECT_TO_CALC"], "rewrite_time": 2396}
{"name": "query20_0", "input_sql": "select\n\ts_name,\n\ts_address\nfrom\n\tsupplier,\n\tnation\nwhere\n\ts_suppkey in (\n\t\tselect\n\t\t\tps_suppkey\n\t\tfrom\n\t\t\tpartsupp\n\t\twhere\n\t\t\tps_partkey in (\n\t\t\t\tselect\n\t\t\t\t\tp_partkey\n\t\t\t\tfrom\n\t\t\t\t\tpart\n\t\t\t\twhere\n\t\t\t\t\tp_name like 'snow%'\n\t\t\t)\n\t\t\tand ps_availqty > (\n\t\t\t\tselect\n\t\t\t\t\t0.5 * sum(l_quantity)\n\t\t\t\tfrom\n\t\t\t\t\tlineitem\n\t\t\t\twhere\n\t\t\t\t\tl_partkey = ps_partkey\n\t\t\t\t\tand l_suppkey = ps_suppkey\n\t\t\t\t\tand l_shipdate >= date '1994-01-01'\n\t\t\t\t\tand l_shipdate < date '1994-01-01' + interval '1' year\n\t\t\t)\n\t)\n\tand s_nationkey = n_nationkey\n\tand n_name = 'EGYPT'\norder by\n\ts_name\nlimit 1;", "input_cost": 58662000004.81, "output_sql": "SELECT \"t7\".\"s_name\", \"t7\".\"s_address\"\r\nFROM (SELECT \"supplier\".\"s_suppkey\", \"supplier\".\"s_name\", \"supplier\".\"s_address\", \"supplier\".\"s_nationkey\", \"supplier\".\"s_phone\", \"supplier\".\"s_acctbal\", \"supplier\".\"s_comment\"\r\n        FROM \"supplier\"\r\n            INNER JOIN (SELECT \"partsupp\".\"ps_suppkey\"\r\n                FROM \"partsupp\"\r\n                    INNER JOIN (SELECT \"p_partkey\"\r\n                        FROM \"part\"\r\n                        WHERE \"p_name\" LIKE 'snow%'\r\n                        GROUP BY \"p_partkey\") AS \"t1\" ON \"partsupp\".\"ps_partkey\" = \"t1\".\"p_partkey\"\r\n                    INNER JOIN (SELECT \"l_partkey\", \"l_suppkey\", SUM(\"l_quantity\") AS \"$f2\"\r\n                        FROM \"lineitem\"\r\n                        WHERE \"l_shipdate\" >= DATE '1994-01-01' AND \"l_shipdate\" < DATE '1995-01-01'\r\n                        GROUP BY \"l_partkey\", \"l_suppkey\") AS \"t4\" ON \"partsupp\".\"ps_partkey\" = \"t4\".\"l_partkey\" AND \"partsupp\".\"ps_suppkey\" = \"t4\".\"l_suppkey\" AND \"partsupp\".\"ps_availqty\" > 0.5 * \"t4\".\"$f2\"\r\n                GROUP BY \"partsupp\".\"ps_suppkey\") AS \"t6\" ON \"supplier\".\"s_suppkey\" = \"t6\".\"ps_suppkey\") AS \"t7\"\r\n    INNER JOIN (SELECT *\r\n        FROM \"nation\"\r\n        WHERE \"n_name\" = 'EGYPT') AS \"t8\" ON \"t7\".\"s_nationkey\" = \"t8\".\"n_nationkey\"\r\nORDER BY \"t7\".\"s_name\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 3240848.86, "used_rules": ["FILTER_INTO_JOIN", "FILTER_SUB_QUERY_TO_CORRELATE", "FILTER_REDUCE_EXPRESSIONS", "SORT_PROJECT_TRANSPOSE", "PROJECT_TO_CALC", "CALC_MERGE"], "rewrite_time": 1410}
{"name": "query20_1", "input_sql": "select\n\ts_name,\n\ts_address\nfrom\n\tsupplier,\n\tnation\nwhere\n\ts_suppkey in (\n\t\tselect\n\t\t\tps_suppkey\n\t\tfrom\n\t\t\tpartsupp\n\t\twhere\n\t\t\tps_partkey in (\n\t\t\t\tselect\n\t\t\t\t\tp_partkey\n\t\t\t\tfrom\n\t\t\t\t\tpart\n\t\t\t\twhere\n\t\t\t\t\tp_name like 'floral%'\n\t\t\t)\n\t\t\tand ps_availqty > (\n\t\t\t\tselect\n\t\t\t\t\t0.5 * sum(l_quantity)\n\t\t\t\tfrom\n\t\t\t\t\tlineitem\n\t\t\t\twhere\n\t\t\t\t\tl_partkey = ps_partkey\n\t\t\t\t\tand l_suppkey = ps_suppkey\n\t\t\t\t\tand l_shipdate >= date '1997-01-01'\n\t\t\t\t\tand l_shipdate < date '1997-01-01' + interval '1' year\n\t\t\t)\n\t)\n\tand s_nationkey = n_nationkey\n\tand n_name = 'CHINA'\norder by\n\ts_name\nlimit 1;", "input_cost": 117690158884.12, "output_sql": "SELECT \"t7\".\"s_name\", \"t7\".\"s_address\"\r\nFROM (SELECT \"supplier\".\"s_suppkey\", \"supplier\".\"s_name\", \"supplier\".\"s_address\", \"supplier\".\"s_nationkey\", \"supplier\".\"s_phone\", \"supplier\".\"s_acctbal\", \"supplier\".\"s_comment\"\r\n        FROM \"supplier\"\r\n            INNER JOIN (SELECT \"partsupp\".\"ps_suppkey\"\r\n                FROM \"partsupp\"\r\n                    INNER JOIN (SELECT \"p_partkey\"\r\n                        FROM \"part\"\r\n                        WHERE \"p_name\" LIKE 'floral%'\r\n                        GROUP BY \"p_partkey\") AS \"t1\" ON \"partsupp\".\"ps_partkey\" = \"t1\".\"p_partkey\"\r\n                    INNER JOIN (SELECT \"l_partkey\", \"l_suppkey\", SUM(\"l_quantity\") AS \"$f2\"\r\n                        FROM \"lineitem\"\r\n                        WHERE \"l_shipdate\" >= DATE '1997-01-01' AND \"l_shipdate\" < DATE '1998-01-01'\r\n                        GROUP BY \"l_partkey\", \"l_suppkey\") AS \"t4\" ON \"partsupp\".\"ps_partkey\" = \"t4\".\"l_partkey\" AND \"partsupp\".\"ps_suppkey\" = \"t4\".\"l_suppkey\" AND \"partsupp\".\"ps_availqty\" > 0.5 * \"t4\".\"$f2\"\r\n                GROUP BY \"partsupp\".\"ps_suppkey\") AS \"t6\" ON \"supplier\".\"s_suppkey\" = \"t6\".\"ps_suppkey\") AS \"t7\"\r\n    INNER JOIN (SELECT *\r\n        FROM \"nation\"\r\n        WHERE \"n_name\" = 'CHINA') AS \"t8\" ON \"t7\".\"s_nationkey\" = \"t8\".\"n_nationkey\"\r\nORDER BY \"t7\".\"s_name\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 3219699.13, "used_rules": ["FILTER_INTO_JOIN", "FILTER_SUB_QUERY_TO_CORRELATE", "FILTER_REDUCE_EXPRESSIONS", "SORT_PROJECT_TRANSPOSE", "PROJECT_TO_CALC", "CALC_MERGE"], "rewrite_time": 1362}
{"name": "query21_0", "input_sql": "select\n\ts_name,\n\tcount(*) as numwait\nfrom\n\tsupplier,\n\tlineitem l1,\n\torders,\n\tnation\nwhere\n\ts_suppkey = l1.l_suppkey\n\tand o_orderkey = l1.l_orderkey\n\tand o_orderstatus = 'F'\n\tand l1.l_receiptdate > l1.l_commitdate\n\tand exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tlineitem l2\n\t\twhere\n\t\t\tl2.l_orderkey = l1.l_orderkey\n\t\t\tand l2.l_suppkey <> l1.l_suppkey\n\t)\n\tand not exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tlineitem l3\n\t\twhere\n\t\t\tl3.l_orderkey = l1.l_orderkey\n\t\t\tand l3.l_suppkey <> l1.l_suppkey\n\t\t\tand l3.l_receiptdate > l3.l_commitdate\n\t)\n\tand s_nationkey = n_nationkey\n\tand n_name = 'FRANCE'\ngroup by\n\ts_name\norder by\n\tnumwait desc,\n\ts_name\nlimit 100;", "input_cost": 5042935.44, "output_sql": "SELECT \"supplier\".\"s_name\", COUNT(*) AS \"numwait\"\r\nFROM \"supplier\"\r\n    INNER JOIN (SELECT *\r\n        FROM \"lineitem\"\r\n        WHERE \"l_receiptdate\" > \"l_commitdate\") AS \"t\" ON \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\"\r\n    INNER JOIN (SELECT *\r\n        FROM \"orders\"\r\n        WHERE \"o_orderstatus\" = 'F') AS \"t0\" ON \"t\".\"l_orderkey\" = \"t0\".\"o_orderkey\"\r\n    INNER JOIN (SELECT *\r\n        FROM \"nation\"\r\n        WHERE \"n_name\" = 'FRANCE') AS \"t1\" ON \"supplier\".\"s_nationkey\" = \"t1\".\"n_nationkey\"\r\n    INNER JOIN (SELECT \"t10\".\"l_orderkey1\", \"t10\".\"l_suppkey1\"\r\n        FROM \"lineitem\" AS \"lineitem0\" (\"l_orderkey0\", \"l_partkey0\", \"l_suppkey0\", \"l_linenumber0\", \"l_quantity0\", \"l_extendedprice0\", \"l_discount0\", \"l_tax0\", \"l_returnflag0\", \"l_linestatus0\", \"l_shipdate0\", \"l_commitdate0\", \"l_receiptdate0\", \"l_shipinstruct0\", \"l_shipmode0\", \"l_comment0\")\r\n            INNER JOIN (SELECT \"t5\".\"l_orderkey1\", \"t5\".\"l_suppkey1\"\r\n                FROM (SELECT \"t2\".\"s_nationkey0\", \"t4\".\"l_orderkey1\", \"t4\".\"l_suppkey1\"\r\n                        FROM (SELECT \"s_suppkey0\", \"s_nationkey0\"\r\n                                FROM \"supplier\" AS \"supplier0\" (\"s_suppkey0\", \"s_name0\", \"s_address0\", \"s_nationkey0\", \"s_phone0\", \"s_acctbal0\", \"s_comment0\")\r\n                                GROUP BY \"s_suppkey0\", \"s_nationkey0\") AS \"t2\"\r\n                            INNER JOIN (SELECT \"l_orderkey1\", \"l_suppkey1\"\r\n                                FROM \"lineitem\" AS \"lineitem1\" (\"l_orderkey1\", \"l_partkey1\", \"l_suppkey1\", \"l_linenumber1\", \"l_quantity1\", \"l_extendedprice1\", \"l_discount1\", \"l_tax1\", \"l_returnflag1\", \"l_linestatus1\", \"l_shipdate1\", \"l_commitdate1\", \"l_receiptdate1\", \"l_shipinstruct1\", \"l_shipmode1\", \"l_comment1\")\r\n                                WHERE \"l_receiptdate1\" > \"l_commitdate1\"\r\n                                GROUP BY \"l_orderkey1\", \"l_suppkey1\") AS \"t4\" ON \"t2\".\"s_suppkey0\" = \"t4\".\"l_suppkey1\"\r\n                        GROUP BY \"t2\".\"s_nationkey0\", \"t4\".\"l_orderkey1\", \"t4\".\"l_suppkey1\") AS \"t5\"\r\n                    INNER JOIN (SELECT \"o_orderkey0\"\r\n                        FROM \"orders\" AS \"orders0\" (\"o_orderkey0\", \"o_custkey0\", \"o_orderstatus0\", \"o_totalprice0\", \"o_orderdate0\", \"o_orderpriority0\", \"o_clerk0\", \"o_shippriority0\", \"o_comment0\")\r\n                        WHERE \"o_orderstatus0\" = 'F'\r\n                        GROUP BY \"o_orderkey0\") AS \"t7\" ON \"t5\".\"l_orderkey1\" = \"t7\".\"o_orderkey0\"\r\n                    INNER JOIN (SELECT \"n_nationkey0\"\r\n                        FROM \"nation\" AS \"nation0\" (\"n_nationkey0\", \"n_name0\", \"n_regionkey0\", \"n_comment0\")\r\n                        WHERE \"n_name0\" = 'FRANCE'\r\n                        GROUP BY \"n_nationkey0\") AS \"t9\" ON \"t5\".\"s_nationkey0\" = \"t9\".\"n_nationkey0\"\r\n                GROUP BY \"t5\".\"l_orderkey1\", \"t5\".\"l_suppkey1\") AS \"t10\" ON \"lineitem0\".\"l_orderkey0\" = \"t10\".\"l_orderkey1\" AND \"lineitem0\".\"l_suppkey0\" <> \"t10\".\"l_suppkey1\"\r\n        GROUP BY \"t10\".\"l_orderkey1\", \"t10\".\"l_suppkey1\") AS \"t11\" ON \"t\".\"l_orderkey\" = \"t11\".\"l_orderkey1\" AND \"t\".\"l_suppkey\" = \"t11\".\"l_suppkey1\"\r\n    LEFT JOIN (SELECT \"t21\".\"l_orderkey3\", \"t21\".\"l_suppkey3\", TRUE AS \"$f2\"\r\n        FROM (SELECT *\r\n                FROM \"lineitem\" AS \"lineitem2\" (\"l_orderkey2\", \"l_partkey2\", \"l_suppkey2\", \"l_linenumber2\", \"l_quantity2\", \"l_extendedprice2\", \"l_discount2\", \"l_tax2\", \"l_returnflag2\", \"l_linestatus2\", \"l_shipdate2\", \"l_commitdate2\", \"l_receiptdate2\", \"l_shipinstruct2\", \"l_shipmode2\", \"l_comment2\")\r\n                WHERE \"l_receiptdate2\" > \"l_commitdate2\") AS \"t12\"\r\n            INNER JOIN (SELECT \"t16\".\"l_orderkey3\", \"t16\".\"l_suppkey3\"\r\n                FROM (SELECT \"t13\".\"s_nationkey1\", \"t15\".\"l_orderkey3\", \"t15\".\"l_suppkey3\"\r\n                        FROM (SELECT \"s_suppkey1\", \"s_nationkey1\"\r\n                                FROM \"supplier\" AS \"supplier1\" (\"s_suppkey1\", \"s_name1\", \"s_address1\", \"s_nationkey1\", \"s_phone1\", \"s_acctbal1\", \"s_comment1\")\r\n                                GROUP BY \"s_suppkey1\", \"s_nationkey1\") AS \"t13\"\r\n                            INNER JOIN (SELECT \"l_orderkey3\", \"l_suppkey3\"\r\n                                FROM \"lineitem\" AS \"lineitem3\" (\"l_orderkey3\", \"l_partkey3\", \"l_suppkey3\", \"l_linenumber3\", \"l_quantity3\", \"l_extendedprice3\", \"l_discount3\", \"l_tax3\", \"l_returnflag3\", \"l_linestatus3\", \"l_shipdate3\", \"l_commitdate3\", \"l_receiptdate3\", \"l_shipinstruct3\", \"l_shipmode3\", \"l_comment3\")\r\n                                WHERE \"l_receiptdate3\" > \"l_commitdate3\"\r\n                                GROUP BY \"l_orderkey3\", \"l_suppkey3\") AS \"t15\" ON \"t13\".\"s_suppkey1\" = \"t15\".\"l_suppkey3\"\r\n                        GROUP BY \"t13\".\"s_nationkey1\", \"t15\".\"l_orderkey3\", \"t15\".\"l_suppkey3\") AS \"t16\"\r\n                    INNER JOIN (SELECT \"o_orderkey1\"\r\n                        FROM \"orders\" AS \"orders1\" (\"o_orderkey1\", \"o_custkey1\", \"o_orderstatus1\", \"o_totalprice1\", \"o_orderdate1\", \"o_orderpriority1\", \"o_clerk1\", \"o_shippriority1\", \"o_comment1\")\r\n                        WHERE \"o_orderstatus1\" = 'F'\r\n                        GROUP BY \"o_orderkey1\") AS \"t18\" ON \"t16\".\"l_orderkey3\" = \"t18\".\"o_orderkey1\"\r\n                    INNER JOIN (SELECT \"n_nationkey1\"\r\n                        FROM \"nation\" AS \"nation1\" (\"n_nationkey1\", \"n_name1\", \"n_regionkey1\", \"n_comment1\")\r\n                        WHERE \"n_name1\" = 'FRANCE'\r\n                        GROUP BY \"n_nationkey1\") AS \"t20\" ON \"t16\".\"s_nationkey1\" = \"t20\".\"n_nationkey1\"\r\n                GROUP BY \"t16\".\"l_orderkey3\", \"t16\".\"l_suppkey3\") AS \"t21\" ON \"t12\".\"l_orderkey2\" = \"t21\".\"l_orderkey3\" AND \"t12\".\"l_suppkey2\" <> \"t21\".\"l_suppkey3\"\r\n        GROUP BY \"t21\".\"l_orderkey3\", \"t21\".\"l_suppkey3\") AS \"t23\" ON \"t\".\"l_orderkey\" = \"t23\".\"l_orderkey3\" AND \"t\".\"l_suppkey\" = \"t23\".\"l_suppkey3\"\r\nWHERE \"t23\".\"$f2\" IS NULL\r\nGROUP BY \"supplier\".\"s_name\"\r\nORDER BY 2 DESC, \"supplier\".\"s_name\"\r\nFETCH NEXT 100 ROWS ONLY;", "output_cost": 560381166.75, "used_rules": ["FILTER_SUB_QUERY_TO_CORRELATE", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_JOIN_TRANSPOSE_EXTENDED", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_JOIN_TRANSPOSE_EXTENDED", "AGGREGATE_PROJECT_MERGE", "JOIN_PROJECT_LEFT_TRANSPOSE", "JOIN_EXTRACT_FILTER", "JOIN_PROJECT_RIGHT_TRANSPOSE", "FILTER_INTO_JOIN", "FILTER_PROJECT_TRANSPOSE", "FILTER_INTO_JOIN", "JOIN_PROJECT_BOTH_TRANSPOSE", "JOIN_EXTRACT_FILTER", "FILTER_INTO_JOIN", "FILTER_PROJECT_TRANSPOSE", "PROJECT_REDUCE_EXPRESSIONS", "AGGREGATE_PROJECT_MERGE"], "rewrite_time": 3584}
{"name": "query21_1", "input_sql": "select\n\ts_name,\n\tcount(*) as numwait\nfrom\n\tsupplier,\n\tlineitem l1,\n\torders,\n\tnation\nwhere\n\ts_suppkey = l1.l_suppkey\n\tand o_orderkey = l1.l_orderkey\n\tand o_orderstatus = 'F'\n\tand l1.l_receiptdate > l1.l_commitdate\n\tand exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tlineitem l2\n\t\twhere\n\t\t\tl2.l_orderkey = l1.l_orderkey\n\t\t\tand l2.l_suppkey <> l1.l_suppkey\n\t)\n\tand not exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tlineitem l3\n\t\twhere\n\t\t\tl3.l_orderkey = l1.l_orderkey\n\t\t\tand l3.l_suppkey <> l1.l_suppkey\n\t\t\tand l3.l_receiptdate > l3.l_commitdate\n\t)\n\tand s_nationkey = n_nationkey\n\tand n_name = 'UNITED KINGDOM'\ngroup by\n\ts_name\norder by\n\tnumwait desc,\n\ts_name\nlimit 100;", "input_cost": 5042935.44, "output_sql": "SELECT \"supplier\".\"s_name\", COUNT(*) AS \"numwait\"\r\nFROM \"supplier\"\r\n    INNER JOIN (SELECT *\r\n        FROM \"lineitem\"\r\n        WHERE \"l_receiptdate\" > \"l_commitdate\") AS \"t\" ON \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\"\r\n    INNER JOIN (SELECT *\r\n        FROM \"orders\"\r\n        WHERE \"o_orderstatus\" = 'F') AS \"t0\" ON \"t\".\"l_orderkey\" = \"t0\".\"o_orderkey\"\r\n    INNER JOIN (SELECT *\r\n        FROM \"nation\"\r\n        WHERE \"n_name\" = 'UNITED KINGDOM') AS \"t1\" ON \"supplier\".\"s_nationkey\" = \"t1\".\"n_nationkey\"\r\n    INNER JOIN (SELECT \"t10\".\"l_orderkey1\", \"t10\".\"l_suppkey1\"\r\n        FROM \"lineitem\" AS \"lineitem0\" (\"l_orderkey0\", \"l_partkey0\", \"l_suppkey0\", \"l_linenumber0\", \"l_quantity0\", \"l_extendedprice0\", \"l_discount0\", \"l_tax0\", \"l_returnflag0\", \"l_linestatus0\", \"l_shipdate0\", \"l_commitdate0\", \"l_receiptdate0\", \"l_shipinstruct0\", \"l_shipmode0\", \"l_comment0\")\r\n            INNER JOIN (SELECT \"t5\".\"l_orderkey1\", \"t5\".\"l_suppkey1\"\r\n                FROM (SELECT \"t2\".\"s_nationkey0\", \"t4\".\"l_orderkey1\", \"t4\".\"l_suppkey1\"\r\n                        FROM (SELECT \"s_suppkey0\", \"s_nationkey0\"\r\n                                FROM \"supplier\" AS \"supplier0\" (\"s_suppkey0\", \"s_name0\", \"s_address0\", \"s_nationkey0\", \"s_phone0\", \"s_acctbal0\", \"s_comment0\")\r\n                                GROUP BY \"s_suppkey0\", \"s_nationkey0\") AS \"t2\"\r\n                            INNER JOIN (SELECT \"l_orderkey1\", \"l_suppkey1\"\r\n                                FROM \"lineitem\" AS \"lineitem1\" (\"l_orderkey1\", \"l_partkey1\", \"l_suppkey1\", \"l_linenumber1\", \"l_quantity1\", \"l_extendedprice1\", \"l_discount1\", \"l_tax1\", \"l_returnflag1\", \"l_linestatus1\", \"l_shipdate1\", \"l_commitdate1\", \"l_receiptdate1\", \"l_shipinstruct1\", \"l_shipmode1\", \"l_comment1\")\r\n                                WHERE \"l_receiptdate1\" > \"l_commitdate1\"\r\n                                GROUP BY \"l_orderkey1\", \"l_suppkey1\") AS \"t4\" ON \"t2\".\"s_suppkey0\" = \"t4\".\"l_suppkey1\"\r\n                        GROUP BY \"t2\".\"s_nationkey0\", \"t4\".\"l_orderkey1\", \"t4\".\"l_suppkey1\") AS \"t5\"\r\n                    INNER JOIN (SELECT \"o_orderkey0\"\r\n                        FROM \"orders\" AS \"orders0\" (\"o_orderkey0\", \"o_custkey0\", \"o_orderstatus0\", \"o_totalprice0\", \"o_orderdate0\", \"o_orderpriority0\", \"o_clerk0\", \"o_shippriority0\", \"o_comment0\")\r\n                        WHERE \"o_orderstatus0\" = 'F'\r\n                        GROUP BY \"o_orderkey0\") AS \"t7\" ON \"t5\".\"l_orderkey1\" = \"t7\".\"o_orderkey0\"\r\n                    INNER JOIN (SELECT \"n_nationkey0\"\r\n                        FROM \"nation\" AS \"nation0\" (\"n_nationkey0\", \"n_name0\", \"n_regionkey0\", \"n_comment0\")\r\n                        WHERE \"n_name0\" = 'UNITED KINGDOM'\r\n                        GROUP BY \"n_nationkey0\") AS \"t9\" ON \"t5\".\"s_nationkey0\" = \"t9\".\"n_nationkey0\"\r\n                GROUP BY \"t5\".\"l_orderkey1\", \"t5\".\"l_suppkey1\") AS \"t10\" ON \"lineitem0\".\"l_orderkey0\" = \"t10\".\"l_orderkey1\" AND \"lineitem0\".\"l_suppkey0\" <> \"t10\".\"l_suppkey1\"\r\n        GROUP BY \"t10\".\"l_orderkey1\", \"t10\".\"l_suppkey1\") AS \"t11\" ON \"t\".\"l_orderkey\" = \"t11\".\"l_orderkey1\" AND \"t\".\"l_suppkey\" = \"t11\".\"l_suppkey1\"\r\n    LEFT JOIN (SELECT \"t21\".\"l_orderkey3\", \"t21\".\"l_suppkey3\", TRUE AS \"$f2\"\r\n        FROM (SELECT *\r\n                FROM \"lineitem\" AS \"lineitem2\" (\"l_orderkey2\", \"l_partkey2\", \"l_suppkey2\", \"l_linenumber2\", \"l_quantity2\", \"l_extendedprice2\", \"l_discount2\", \"l_tax2\", \"l_returnflag2\", \"l_linestatus2\", \"l_shipdate2\", \"l_commitdate2\", \"l_receiptdate2\", \"l_shipinstruct2\", \"l_shipmode2\", \"l_comment2\")\r\n                WHERE \"l_receiptdate2\" > \"l_commitdate2\") AS \"t12\"\r\n            INNER JOIN (SELECT \"t16\".\"l_orderkey3\", \"t16\".\"l_suppkey3\"\r\n                FROM (SELECT \"t13\".\"s_nationkey1\", \"t15\".\"l_orderkey3\", \"t15\".\"l_suppkey3\"\r\n                        FROM (SELECT \"s_suppkey1\", \"s_nationkey1\"\r\n                                FROM \"supplier\" AS \"supplier1\" (\"s_suppkey1\", \"s_name1\", \"s_address1\", \"s_nationkey1\", \"s_phone1\", \"s_acctbal1\", \"s_comment1\")\r\n                                GROUP BY \"s_suppkey1\", \"s_nationkey1\") AS \"t13\"\r\n                            INNER JOIN (SELECT \"l_orderkey3\", \"l_suppkey3\"\r\n                                FROM \"lineitem\" AS \"lineitem3\" (\"l_orderkey3\", \"l_partkey3\", \"l_suppkey3\", \"l_linenumber3\", \"l_quantity3\", \"l_extendedprice3\", \"l_discount3\", \"l_tax3\", \"l_returnflag3\", \"l_linestatus3\", \"l_shipdate3\", \"l_commitdate3\", \"l_receiptdate3\", \"l_shipinstruct3\", \"l_shipmode3\", \"l_comment3\")\r\n                                WHERE \"l_receiptdate3\" > \"l_commitdate3\"\r\n                                GROUP BY \"l_orderkey3\", \"l_suppkey3\") AS \"t15\" ON \"t13\".\"s_suppkey1\" = \"t15\".\"l_suppkey3\"\r\n                        GROUP BY \"t13\".\"s_nationkey1\", \"t15\".\"l_orderkey3\", \"t15\".\"l_suppkey3\") AS \"t16\"\r\n                    INNER JOIN (SELECT \"o_orderkey1\"\r\n                        FROM \"orders\" AS \"orders1\" (\"o_orderkey1\", \"o_custkey1\", \"o_orderstatus1\", \"o_totalprice1\", \"o_orderdate1\", \"o_orderpriority1\", \"o_clerk1\", \"o_shippriority1\", \"o_comment1\")\r\n                        WHERE \"o_orderstatus1\" = 'F'\r\n                        GROUP BY \"o_orderkey1\") AS \"t18\" ON \"t16\".\"l_orderkey3\" = \"t18\".\"o_orderkey1\"\r\n                    INNER JOIN (SELECT \"n_nationkey1\"\r\n                        FROM \"nation\" AS \"nation1\" (\"n_nationkey1\", \"n_name1\", \"n_regionkey1\", \"n_comment1\")\r\n                        WHERE \"n_name1\" = 'UNITED KINGDOM'\r\n                        GROUP BY \"n_nationkey1\") AS \"t20\" ON \"t16\".\"s_nationkey1\" = \"t20\".\"n_nationkey1\"\r\n                GROUP BY \"t16\".\"l_orderkey3\", \"t16\".\"l_suppkey3\") AS \"t21\" ON \"t12\".\"l_orderkey2\" = \"t21\".\"l_orderkey3\" AND \"t12\".\"l_suppkey2\" <> \"t21\".\"l_suppkey3\"\r\n        GROUP BY \"t21\".\"l_orderkey3\", \"t21\".\"l_suppkey3\") AS \"t23\" ON \"t\".\"l_orderkey\" = \"t23\".\"l_orderkey3\" AND \"t\".\"l_suppkey\" = \"t23\".\"l_suppkey3\"\r\nWHERE \"t23\".\"$f2\" IS NULL\r\nGROUP BY \"supplier\".\"s_name\"\r\nORDER BY 2 DESC, \"supplier\".\"s_name\"\r\nFETCH NEXT 100 ROWS ONLY;", "output_cost": 560381166.75, "used_rules": ["FILTER_SUB_QUERY_TO_CORRELATE", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_JOIN_TRANSPOSE_EXTENDED", "AGGREGATE_PROJECT_MERGE", "AGGREGATE_JOIN_TRANSPOSE_EXTENDED", "AGGREGATE_PROJECT_MERGE", "JOIN_PROJECT_LEFT_TRANSPOSE", "JOIN_EXTRACT_FILTER", "JOIN_PROJECT_RIGHT_TRANSPOSE", "FILTER_INTO_JOIN", "FILTER_PROJECT_TRANSPOSE", "FILTER_INTO_JOIN", "JOIN_PROJECT_BOTH_TRANSPOSE", "JOIN_EXTRACT_FILTER", "FILTER_INTO_JOIN", "FILTER_PROJECT_TRANSPOSE", "PROJECT_REDUCE_EXPRESSIONS", "AGGREGATE_PROJECT_MERGE"], "rewrite_time": 3774}
{"name": "query22_0", "input_sql": "select\n\tcntrycode,\n\tcount(*) as numcust,\n\tsum(c_acctbal) as totacctbal\nfrom\n\t(\n\t\tselect\n\t\t\tsubstring(c_phone from 1 for 2) as cntrycode,\n\t\t\tc_acctbal\n\t\tfrom\n\t\t\tcustomer\n\t\twhere\n\t\t\tsubstring(c_phone from 1 for 2) in\n\t\t\t\t('14', '29', '27', '23', '32', '10', '12')\n\t\t\tand c_acctbal > (\n\t\t\t\tselect\n\t\t\t\t\tavg(c_acctbal)\n\t\t\t\tfrom\n\t\t\t\t\tcustomer\n\t\t\t\twhere\n\t\t\t\t\tc_acctbal > 0.00\n\t\t\t\t\tand substring(c_phone from 1 for 2) in\n\t\t\t\t\t\t('14', '29', '27', '23', '32', '10', '12')\n\t\t\t)\n\t\t\tand not exists (\n\t\t\t\tselect\n\t\t\t\t\t*\n\t\t\t\tfrom\n\t\t\t\t\torders\n\t\t\t\twhere\n\t\t\t\t\to_custkey = c_custkey\n\t\t\t)\n\t) as custsale\ngroup by\n\tcntrycode\norder by\n\tcntrycode\nlimit 1;", "input_cost": 423937.64, "output_sql": "SELECT SUBSTRING(\"c_phone\", 1, 2) AS \"cntrycode\", COUNT(*) AS \"numcust\", COALESCE(SUM(\"c_acctbal\"), 0) AS \"totacctbal\"\r\nFROM \"customer\"\r\nWHERE (SUBSTRING(\"c_phone\", 1, 2) = '14' OR (SUBSTRING(\"c_phone\", 1, 2) = '29' OR SUBSTRING(\"c_phone\", 1, 2) = '27') OR (SUBSTRING(\"c_phone\", 1, 2) = '23' OR SUBSTRING(\"c_phone\", 1, 2) = '32' OR (SUBSTRING(\"c_phone\", 1, 2) = '10' OR SUBSTRING(\"c_phone\", 1, 2) = '12'))) AND \"c_acctbal\" > (((SELECT AVG(\"c_acctbal0\")\r\n                    FROM \"customer\" AS \"customer0\" (\"c_custkey0\", \"c_name0\", \"c_address0\", \"c_nationkey0\", \"c_phone0\", \"c_acctbal0\", \"c_mktsegment0\", \"c_comment0\")\r\n                    WHERE \"c_acctbal0\" > 0.00 AND (SUBSTRING(\"c_phone0\", 1, 2) = '14' OR (SUBSTRING(\"c_phone0\", 1, 2) = '29' OR SUBSTRING(\"c_phone0\", 1, 2) = '27') OR (SUBSTRING(\"c_phone0\", 1, 2) = '23' OR SUBSTRING(\"c_phone0\", 1, 2) = '32' OR (SUBSTRING(\"c_phone0\", 1, 2) = '10' OR SUBSTRING(\"c_phone0\", 1, 2) = '12')))))) AND NOT EXISTS (SELECT *\r\n        FROM \"orders\"\r\n        WHERE \"o_custkey\" = \"customer\".\"c_custkey\")\r\nGROUP BY SUBSTRING(\"c_phone\", 1, 2)\r\nORDER BY 1\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 472365.51, "used_rules": ["PROJECT_TO_CALC", "AGGREGATE_REDUCE_FUNCTIONS"], "rewrite_time": 1192}
{"name": "query22_1", "input_sql": "select\n\tcntrycode,\n\tcount(*) as numcust,\n\tsum(c_acctbal) as totacctbal\nfrom\n\t(\n\t\tselect\n\t\t\tsubstring(c_phone from 1 for 2) as cntrycode,\n\t\t\tc_acctbal\n\t\tfrom\n\t\t\tcustomer\n\t\twhere\n\t\t\tsubstring(c_phone from 1 for 2) in\n\t\t\t\t('28', '27', '23', '13', '34', '25', '16')\n\t\t\tand c_acctbal > (\n\t\t\t\tselect\n\t\t\t\t\tavg(c_acctbal)\n\t\t\t\tfrom\n\t\t\t\t\tcustomer\n\t\t\t\twhere\n\t\t\t\t\tc_acctbal > 0.00\n\t\t\t\t\tand substring(c_phone from 1 for 2) in\n\t\t\t\t\t\t('28', '27', '23', '13', '34', '25', '16')\n\t\t\t)\n\t\t\tand not exists (\n\t\t\t\tselect\n\t\t\t\t\t*\n\t\t\t\tfrom\n\t\t\t\t\torders\n\t\t\t\twhere\n\t\t\t\t\to_custkey = c_custkey\n\t\t\t)\n\t) as custsale\ngroup by\n\tcntrycode\norder by\n\tcntrycode\nlimit 1;", "input_cost": 423937.64, "output_sql": "SELECT SUBSTRING(\"c_phone\", 1, 2) AS \"cntrycode\", COUNT(*) AS \"numcust\", COALESCE(SUM(\"c_acctbal\"), 0) AS \"totacctbal\"\r\nFROM \"customer\"\r\nWHERE (SUBSTRING(\"c_phone\", 1, 2) = '28' OR (SUBSTRING(\"c_phone\", 1, 2) = '27' OR SUBSTRING(\"c_phone\", 1, 2) = '23') OR (SUBSTRING(\"c_phone\", 1, 2) = '13' OR SUBSTRING(\"c_phone\", 1, 2) = '34' OR (SUBSTRING(\"c_phone\", 1, 2) = '25' OR SUBSTRING(\"c_phone\", 1, 2) = '16'))) AND \"c_acctbal\" > (((SELECT AVG(\"c_acctbal0\")\r\n                    FROM \"customer\" AS \"customer0\" (\"c_custkey0\", \"c_name0\", \"c_address0\", \"c_nationkey0\", \"c_phone0\", \"c_acctbal0\", \"c_mktsegment0\", \"c_comment0\")\r\n                    WHERE \"c_acctbal0\" > 0.00 AND (SUBSTRING(\"c_phone0\", 1, 2) = '28' OR (SUBSTRING(\"c_phone0\", 1, 2) = '27' OR SUBSTRING(\"c_phone0\", 1, 2) = '23') OR (SUBSTRING(\"c_phone0\", 1, 2) = '13' OR SUBSTRING(\"c_phone0\", 1, 2) = '34' OR (SUBSTRING(\"c_phone0\", 1, 2) = '25' OR SUBSTRING(\"c_phone0\", 1, 2) = '16')))))) AND NOT EXISTS (SELECT *\r\n        FROM \"orders\"\r\n        WHERE \"o_custkey\" = \"customer\".\"c_custkey\")\r\nGROUP BY SUBSTRING(\"c_phone\", 1, 2)\r\nORDER BY 1\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 472365.51, "used_rules": ["PROJECT_TO_CALC", "AGGREGATE_REDUCE_FUNCTIONS"], "rewrite_time": 947}
{"name": "query3_0", "input_sql": "select\n\tl_orderkey,\n\tsum(l_extendedprice * (1 - l_discount)) as revenue,\n\to_orderdate,\n\to_shippriority\nfrom\n\tcustomer,\n\torders,\n\tlineitem\nwhere\n\tc_mktsegment = 'FURNITURE'\n\tand c_custkey = o_custkey\n\tand l_orderkey = o_orderkey\n\tand o_orderdate < date '1995-03-28'\n\tand l_shipdate > date '1995-03-28'\ngroup by\n\tl_orderkey,\n\to_orderdate,\n\to_shippriority\norder by\n\trevenue desc,\n\to_orderdate\nlimit 10;", "input_cost": 2695870.22, "output_sql": "SELECT \"t2\".\"l_orderkey\", COALESCE(SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")), 0) AS \"revenue\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nFROM (SELECT *\r\n        FROM (SELECT *\r\n                FROM \"customer\"\r\n                WHERE \"c_mktsegment\" = 'FURNITURE') AS \"t\",\r\n                (SELECT *\r\n                FROM \"orders\"\r\n                WHERE \"o_orderdate\" < DATE '1995-03-28') AS \"t0\"\r\n        WHERE \"t\".\"c_custkey\" = \"t0\".\"o_custkey\") AS \"t1\",\r\n        (SELECT *\r\n        FROM \"lineitem\"\r\n        WHERE \"l_shipdate\" > DATE '1995-03-28') AS \"t2\"\r\nWHERE \"t2\".\"l_orderkey\" = \"t1\".\"o_orderkey\"\r\nGROUP BY \"t2\".\"l_orderkey\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nORDER BY 4 DESC, \"t1\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY;", "output_cost": 2190254.16, "used_rules": ["FILTER_INTO_JOIN", "SORT_PROJECT_TRANSPOSE", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "JOIN_EXTRACT_FILTER"], "rewrite_time": 881}
{"name": "query3_1", "input_sql": "select\n\tl_orderkey,\n\tsum(l_extendedprice * (1 - l_discount)) as revenue,\n\to_orderdate,\n\to_shippriority\nfrom\n\tcustomer,\n\torders,\n\tlineitem\nwhere\n\tc_mktsegment = 'MACHINERY'\n\tand c_custkey = o_custkey\n\tand l_orderkey = o_orderkey\n\tand o_orderdate < date '1995-03-13'\n\tand l_shipdate > date '1995-03-13'\ngroup by\n\tl_orderkey,\n\to_orderdate,\n\to_shippriority\norder by\n\trevenue desc,\n\to_orderdate\nlimit 10;", "input_cost": 2758315.83, "output_sql": "SELECT \"t2\".\"l_orderkey\", COALESCE(SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")), 0) AS \"revenue\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nFROM (SELECT *\r\n        FROM (SELECT *\r\n                FROM \"customer\"\r\n                WHERE \"c_mktsegment\" = 'MACHINERY') AS \"t\",\r\n                (SELECT *\r\n                FROM \"orders\"\r\n                WHERE \"o_orderdate\" < DATE '1995-03-13') AS \"t0\"\r\n        WHERE \"t\".\"c_custkey\" = \"t0\".\"o_custkey\") AS \"t1\",\r\n        (SELECT *\r\n        FROM \"lineitem\"\r\n        WHERE \"l_shipdate\" > DATE '1995-03-13') AS \"t2\"\r\nWHERE \"t2\".\"l_orderkey\" = \"t1\".\"o_orderkey\"\r\nGROUP BY \"t2\".\"l_orderkey\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nORDER BY 4 DESC, \"t1\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY;", "output_cost": 2228424.49, "used_rules": ["FILTER_INTO_JOIN", "SORT_PROJECT_TRANSPOSE", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "JOIN_EXTRACT_FILTER"], "rewrite_time": 830}
{"name": "query4_0", "input_sql": "select\n\to_orderpriority,\n\tcount(*) as order_count\nfrom\n\torders\nwhere\n\to_orderdate >= date '1997-04-01'\n\tand o_orderdate < date '1997-04-01' + interval '3' month\n\tand exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tlineitem\n\t\twhere\n\t\t\tl_orderkey = o_orderkey\n\t\t\tand l_commitdate < l_receiptdate\n\t)\ngroup by\n\to_orderpriority\norder by\n\to_orderpriority\nlimit 1;", "input_cost": 1966768.06, "output_sql": "SELECT \"o_orderpriority\", COUNT(*) AS \"order_count\"\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1997-04-01' AND \"o_orderdate\" < (DATE '1997-04-01' + INTERVAL '3' MONTH) AND EXISTS (SELECT *\r\n        FROM \"lineitem\"\r\n        WHERE \"l_orderkey\" = \"orders\".\"o_orderkey\" AND \"l_commitdate\" < \"l_receiptdate\")\r\nGROUP BY \"o_orderpriority\"\r\nORDER BY \"o_orderpriority\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 1966768.06, "used_rules": ["AGGREGATE_PROJECT_MERGE"], "rewrite_time": 583}
{"name": "query4_1", "input_sql": "select\n\to_orderpriority,\n\tcount(*) as order_count\nfrom\n\torders\nwhere\n\to_orderdate >= date '1995-01-01'\n\tand o_orderdate < date '1995-01-01' + interval '3' month\n\tand exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tlineitem\n\t\twhere\n\t\t\tl_orderkey = o_orderkey\n\t\t\tand l_commitdate < l_receiptdate\n\t)\ngroup by\n\to_orderpriority\norder by\n\to_orderpriority\nlimit 1;", "input_cost": 1966635.3, "output_sql": "SELECT \"o_orderpriority\", COUNT(*) AS \"order_count\"\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" < (DATE '1995-01-01' + INTERVAL '3' MONTH) AND EXISTS (SELECT *\r\n        FROM \"lineitem\"\r\n        WHERE \"l_orderkey\" = \"orders\".\"o_orderkey\" AND \"l_commitdate\" < \"l_receiptdate\")\r\nGROUP BY \"o_orderpriority\"\r\nORDER BY \"o_orderpriority\"\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 1966635.3, "used_rules": ["AGGREGATE_PROJECT_MERGE"], "rewrite_time": 530}
{"name": "query5_0", "input_sql": "select\n\tn_name,\n\tsum(l_extendedprice * (1 - l_discount)) as revenue\nfrom\n\tcustomer,\n\torders,\n\tlineitem,\n\tsupplier,\n\tnation,\n\tregion\nwhere\n\tc_custkey = o_custkey\n\tand l_orderkey = o_orderkey\n\tand l_suppkey = s_suppkey\n\tand c_nationkey = s_nationkey\n\tand s_nationkey = n_nationkey\n\tand n_regionkey = r_regionkey\n\tand r_name = 'EUROPE'\n\tand o_orderdate >= date '1994-01-01'\n\tand o_orderdate < date '1994-01-01' + interval '1' year\ngroup by\n\tn_name\norder by\n\trevenue desc\nlimit 1;", "input_cost": 1877082.84, "output_sql": "SELECT \"t3\".\"n_name\", COALESCE(SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")), 0) AS \"revenue\"\r\nFROM (SELECT *\r\n        FROM (SELECT *\r\n                FROM (SELECT *\r\n                        FROM (SELECT *\r\n                                FROM \"customer\",\r\n                                        (SELECT *\r\n                                        FROM \"orders\"\r\n                                        WHERE \"o_orderdate\" >= DATE '1994-01-01' AND \"o_orderdate\" < DATE '1995-01-01') AS \"t\"\r\n                                WHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n                            \"lineitem\"\r\n                        WHERE \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t1\",\r\n                    \"supplier\"\r\n                WHERE \"t1\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"t1\".\"c_nationkey\" = \"supplier\".\"s_nationkey\") AS \"t2\",\r\n            \"nation\"\r\n        WHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n        (SELECT *\r\n        FROM \"region\"\r\n        WHERE \"r_name\" = 'EUROPE') AS \"t4\"\r\nWHERE \"t3\".\"n_regionkey\" = \"t4\".\"r_regionkey\"\r\nGROUP BY \"t3\".\"n_name\"\r\nORDER BY 2 DESC\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 1877082.84, "used_rules": ["FILTER_INTO_JOIN", "FILTER_REDUCE_EXPRESSIONS", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1031}
{"name": "query5_1", "input_sql": "select\n\tn_name,\n\tsum(l_extendedprice * (1 - l_discount)) as revenue\nfrom\n\tcustomer,\n\torders,\n\tlineitem,\n\tsupplier,\n\tnation,\n\tregion\nwhere\n\tc_custkey = o_custkey\n\tand l_orderkey = o_orderkey\n\tand l_suppkey = s_suppkey\n\tand c_nationkey = s_nationkey\n\tand s_nationkey = n_nationkey\n\tand n_regionkey = r_regionkey\n\tand r_name = 'AFRICA'\n\tand o_orderdate >= date '1995-01-01'\n\tand o_orderdate < date '1995-01-01' + interval '1' year\ngroup by\n\tn_name\norder by\n\trevenue desc\nlimit 1;", "input_cost": 1876966.62, "output_sql": "SELECT \"t3\".\"n_name\", COALESCE(SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")), 0) AS \"revenue\"\r\nFROM (SELECT *\r\n        FROM (SELECT *\r\n                FROM (SELECT *\r\n                        FROM (SELECT *\r\n                                FROM \"customer\",\r\n                                        (SELECT *\r\n                                        FROM \"orders\"\r\n                                        WHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" < DATE '1996-01-01') AS \"t\"\r\n                                WHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n                            \"lineitem\"\r\n                        WHERE \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t1\",\r\n                    \"supplier\"\r\n                WHERE \"t1\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"t1\".\"c_nationkey\" = \"supplier\".\"s_nationkey\") AS \"t2\",\r\n            \"nation\"\r\n        WHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n        (SELECT *\r\n        FROM \"region\"\r\n        WHERE \"r_name\" = 'AFRICA') AS \"t4\"\r\nWHERE \"t3\".\"n_regionkey\" = \"t4\".\"r_regionkey\"\r\nGROUP BY \"t3\".\"n_name\"\r\nORDER BY 2 DESC\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 1876966.62, "used_rules": ["FILTER_INTO_JOIN", "FILTER_REDUCE_EXPRESSIONS", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1073}
{"name": "query6_0", "input_sql": "select\n\tsum(l_extendedprice * l_discount) as revenue\nfrom\n\tlineitem\nwhere\n\tl_shipdate >= date '1994-01-01'\n\tand l_shipdate < date '1994-01-01' + interval '1' year\n\tand l_discount between 0.06 - 0.01 and 0.06 + 0.01\n\tand l_quantity < 24\nlimit 1;", "input_cost": 1690837.6, "output_sql": "SELECT CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(\"l_extendedprice\" * \"l_discount\"), 0) END AS \"revenue\"\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" >= DATE '1994-01-01' AND \"l_shipdate\" < DATE '1995-01-01' AND (\"l_discount\" >= 0.05 AND \"l_discount\" <= 0.07) AND \"l_quantity\" < 24\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 1692033.66, "used_rules": ["PROJECT_TO_CALC", "FILTER_REDUCE_EXPRESSIONS", "AGGREGATE_REDUCE_FUNCTIONS", "SORT_PROJECT_TRANSPOSE", "PROJECT_TO_CALC"], "rewrite_time": 343}
{"name": "query6_1", "input_sql": "select\n\tsum(l_extendedprice * l_discount) as revenue\nfrom\n\tlineitem\nwhere\n\tl_shipdate >= date '1995-01-01'\n\tand l_shipdate < date '1995-01-01' + interval '1' year\n\tand l_discount between 0.04 - 0.01 and 0.04 + 0.01\n\tand l_quantity < 25\nlimit 1;", "input_cost": 1690946.22, "output_sql": "SELECT CASE WHEN COUNT(*) = 0 THEN NULL ELSE COALESCE(SUM(\"l_extendedprice\" * \"l_discount\"), 0) END AS \"revenue\"\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" < DATE '1996-01-01' AND (\"l_discount\" >= 0.03 AND \"l_discount\" <= 0.05) AND \"l_quantity\" < 25\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 1692196.6, "used_rules": ["PROJECT_TO_CALC", "FILTER_REDUCE_EXPRESSIONS", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC"], "rewrite_time": 343}
{"name": "query7_0", "input_sql": "select\n\tsupp_nation,\n\tcust_nation,\n\tl_year,\n\tsum(volume) as revenue\nfrom\n\t(\n\t\tselect\n\t\t\tn1.n_name as supp_nation,\n\t\t\tn2.n_name as cust_nation,\n\t\t\textract(year from l_shipdate) as l_year,\n\t\t\tl_extendedprice * (1 - l_discount) as volume\n\t\tfrom\n\t\t\tsupplier,\n\t\t\tlineitem,\n\t\t\torders,\n\t\t\tcustomer,\n\t\t\tnation n1,\n\t\t\tnation n2\n\t\twhere\n\t\t\ts_suppkey = l_suppkey\n\t\t\tand o_orderkey = l_orderkey\n\t\t\tand c_custkey = o_custkey\n\t\t\tand s_nationkey = n1.n_nationkey\n\t\t\tand c_nationkey = n2.n_nationkey\n\t\t\tand (\n\t\t\t\t(n1.n_name = 'KENYA' and n2.n_name = 'CANADA')\n\t\t\t\tor (n1.n_name = 'CANADA' and n2.n_name = 'KENYA')\n\t\t\t)\n\t\t\tand l_shipdate between date '1995-01-01' and date '1996-12-31'\n\t) as shipping\ngroup by\n\tsupp_nation,\n\tcust_nation,\n\tl_year\norder by\n\tsupp_nation,\n\tcust_nation,\n\tl_year\nlimit 1;", "input_cost": 1932585.37, "output_sql": "SELECT \"t3\".\"n_name\" AS \"s_suppkey\", \"nation0\".\"n_name0\" AS \"s_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"s_address\", COALESCE(SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")), 0) AS \"revenue\"\r\nFROM (SELECT *\r\n        FROM (SELECT *\r\n                FROM (SELECT *\r\n                        FROM (SELECT *\r\n                                FROM \"supplier\",\r\n                                        (SELECT *\r\n                                        FROM \"lineitem\"\r\n                                        WHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\r\n                                WHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\r\n                            \"orders\"\r\n                        WHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\r\n                    \"customer\"\r\n                WHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\r\n            \"nation\"\r\n        WHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n    \"nation\" AS \"nation0\" (\"n_nationkey0\", \"n_name0\", \"n_regionkey0\", \"n_comment0\")\r\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey0\" AND (\"t3\".\"n_name\" = 'KENYA' AND \"nation0\".\"n_name0\" = 'CANADA' OR \"t3\".\"n_name\" = 'CANADA' AND \"nation0\".\"n_name0\" = 'KENYA')\r\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name0\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\r\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name0\", 3\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 1932585.37, "used_rules": ["FILTER_INTO_JOIN", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1199}
{"name": "query7_1", "input_sql": "select\n\tsupp_nation,\n\tcust_nation,\n\tl_year,\n\tsum(volume) as revenue\nfrom\n\t(\n\t\tselect\n\t\t\tn1.n_name as supp_nation,\n\t\t\tn2.n_name as cust_nation,\n\t\t\textract(year from l_shipdate) as l_year,\n\t\t\tl_extendedprice * (1 - l_discount) as volume\n\t\tfrom\n\t\t\tsupplier,\n\t\t\tlineitem,\n\t\t\torders,\n\t\t\tcustomer,\n\t\t\tnation n1,\n\t\t\tnation n2\n\t\twhere\n\t\t\ts_suppkey = l_suppkey\n\t\t\tand o_orderkey = l_orderkey\n\t\t\tand c_custkey = o_custkey\n\t\t\tand s_nationkey = n1.n_nationkey\n\t\t\tand c_nationkey = n2.n_nationkey\n\t\t\tand (\n\t\t\t\t(n1.n_name = 'FRANCE' and n2.n_name = 'SAUDI ARABIA')\n\t\t\t\tor (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'FRANCE')\n\t\t\t)\n\t\t\tand l_shipdate between date '1995-01-01' and date '1996-12-31'\n\t) as shipping\ngroup by\n\tsupp_nation,\n\tcust_nation,\n\tl_year\norder by\n\tsupp_nation,\n\tcust_nation,\n\tl_year\nlimit 1;", "input_cost": 1932585.37, "output_sql": "SELECT \"t3\".\"n_name\" AS \"s_suppkey\", \"nation0\".\"n_name0\" AS \"s_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"s_address\", COALESCE(SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")), 0) AS \"revenue\"\r\nFROM (SELECT *\r\n        FROM (SELECT *\r\n                FROM (SELECT *\r\n                        FROM (SELECT *\r\n                                FROM \"supplier\",\r\n                                        (SELECT *\r\n                                        FROM \"lineitem\"\r\n                                        WHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\r\n                                WHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\r\n                            \"orders\"\r\n                        WHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\r\n                    \"customer\"\r\n                WHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\r\n            \"nation\"\r\n        WHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n    \"nation\" AS \"nation0\" (\"n_nationkey0\", \"n_name0\", \"n_regionkey0\", \"n_comment0\")\r\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey0\" AND (\"t3\".\"n_name\" = 'FRANCE' AND \"nation0\".\"n_name0\" = 'SAUDI ARABIA' OR \"t3\".\"n_name\" = 'SAUDI ARABIA' AND \"nation0\".\"n_name0\" = 'FRANCE')\r\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name0\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\r\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name0\", 3\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 1932585.37, "used_rules": ["FILTER_INTO_JOIN", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1226}
{"name": "query8_0", "input_sql": "select\n\to_year,\n\tsum(case\n\t\twhen nation = 'CANADA' then volume\n\t\telse 0\n\tend) / sum(volume) as mkt_share\nfrom\n\t(\n\t\tselect\n\t\t\textract(year from o_orderdate) as o_year,\n\t\t\tl_extendedprice * (1 - l_discount) as volume,\n\t\t\tn2.n_name as nation\n\t\tfrom\n\t\t\tpart,\n\t\t\tsupplier,\n\t\t\tlineitem,\n\t\t\torders,\n\t\t\tcustomer,\n\t\t\tnation n1,\n\t\t\tnation n2,\n\t\t\tregion\n\t\twhere\n\t\t\tp_partkey = l_partkey\n\t\t\tand s_suppkey = l_suppkey\n\t\t\tand l_orderkey = o_orderkey\n\t\t\tand o_custkey = c_custkey\n\t\t\tand c_nationkey = n1.n_nationkey\n\t\t\tand n1.n_regionkey = r_regionkey\n\t\t\tand r_name = 'AMERICA'\n\t\t\tand s_nationkey = n2.n_nationkey\n\t\t\tand o_orderdate between date '1995-01-01' and date '1996-12-31'\n\t\t\tand p_type = 'SMALL BURNISHED STEEL'\n\t) as all_nations\ngroup by\n\to_year\norder by\n\to_year\nlimit 1;", "input_cost": 779799.5, "output_sql": "SELECT EXTRACT(YEAR FROM \"t5\".\"o_orderdate\") AS \"p_partkey\", COALESCE(SUM(CASE WHEN CAST(\"t5\".\"n_name0\" AS CHAR(6)) = 'CANADA' THEN \"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\") ELSE 0 END), 0) / COALESCE(SUM(\"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\")), 0) AS \"$f1\"\r\nFROM (SELECT *\r\n        FROM (SELECT *\r\n                FROM (SELECT *\r\n                        FROM (SELECT *\r\n                                FROM (SELECT *\r\n                                        FROM (SELECT *\r\n                                                FROM \"part\"\r\n                                                WHERE \"p_type\" = 'SMALL BURNISHED STEEL') AS \"t\",\r\n                                            \"supplier\",\r\n                                            \"lineitem\"\r\n                                        WHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\") AS \"t0\",\r\n                                        (SELECT *\r\n                                        FROM \"orders\"\r\n                                        WHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t1\"\r\n                                WHERE \"t0\".\"l_orderkey\" = \"t1\".\"o_orderkey\") AS \"t2\",\r\n                            \"customer\"\r\n                        WHERE \"t2\".\"o_custkey\" = \"customer\".\"c_custkey\") AS \"t3\",\r\n                    \"nation\"\r\n                WHERE \"t3\".\"c_nationkey\" = \"nation\".\"n_nationkey\") AS \"t4\",\r\n            \"nation\" AS \"nation0\" (\"n_nationkey0\", \"n_name0\", \"n_regionkey0\", \"n_comment0\")\r\n        WHERE \"t4\".\"s_nationkey\" = \"nation0\".\"n_nationkey0\") AS \"t5\",\r\n        (SELECT *\r\n        FROM \"region\"\r\n        WHERE \"r_name\" = 'AMERICA') AS \"t6\"\r\nWHERE \"t5\".\"n_regionkey\" = \"t6\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")\r\nORDER BY 1\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 779799.51, "used_rules": ["FILTER_INTO_JOIN", "SORT_PROJECT_TRANSPOSE", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1590}
{"name": "query8_1", "input_sql": "select\n\to_year,\n\tsum(case\n\t\twhen nation = 'SAUDI ARABIA' then volume\n\t\telse 0\n\tend) / sum(volume) as mkt_share\nfrom\n\t(\n\t\tselect\n\t\t\textract(year from o_orderdate) as o_year,\n\t\t\tl_extendedprice * (1 - l_discount) as volume,\n\t\t\tn2.n_name as nation\n\t\tfrom\n\t\t\tpart,\n\t\t\tsupplier,\n\t\t\tlineitem,\n\t\t\torders,\n\t\t\tcustomer,\n\t\t\tnation n1,\n\t\t\tnation n2,\n\t\t\tregion\n\t\twhere\n\t\t\tp_partkey = l_partkey\n\t\t\tand s_suppkey = l_suppkey\n\t\t\tand l_orderkey = o_orderkey\n\t\t\tand o_custkey = c_custkey\n\t\t\tand c_nationkey = n1.n_nationkey\n\t\t\tand n1.n_regionkey = r_regionkey\n\t\t\tand r_name = 'MIDDLE EAST'\n\t\t\tand s_nationkey = n2.n_nationkey\n\t\t\tand o_orderdate between date '1995-01-01' and date '1996-12-31'\n\t\t\tand p_type = 'STANDARD BRUSHED STEEL'\n\t) as all_nations\ngroup by\n\to_year\norder by\n\to_year\nlimit 1;", "input_cost": 779799.5, "output_sql": "SELECT EXTRACT(YEAR FROM \"t5\".\"o_orderdate\") AS \"p_partkey\", COALESCE(SUM(CASE WHEN CAST(\"t5\".\"n_name0\" AS CHAR(12)) = 'SAUDI ARABIA' THEN \"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\") ELSE 0 END), 0) / COALESCE(SUM(\"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\")), 0) AS \"$f1\"\r\nFROM (SELECT *\r\n        FROM (SELECT *\r\n                FROM (SELECT *\r\n                        FROM (SELECT *\r\n                                FROM (SELECT *\r\n                                        FROM (SELECT *\r\n                                                FROM \"part\"\r\n                                                WHERE \"p_type\" = 'STANDARD BRUSHED STEEL') AS \"t\",\r\n                                            \"supplier\",\r\n                                            \"lineitem\"\r\n                                        WHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\") AS \"t0\",\r\n                                        (SELECT *\r\n                                        FROM \"orders\"\r\n                                        WHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t1\"\r\n                                WHERE \"t0\".\"l_orderkey\" = \"t1\".\"o_orderkey\") AS \"t2\",\r\n                            \"customer\"\r\n                        WHERE \"t2\".\"o_custkey\" = \"customer\".\"c_custkey\") AS \"t3\",\r\n                    \"nation\"\r\n                WHERE \"t3\".\"c_nationkey\" = \"nation\".\"n_nationkey\") AS \"t4\",\r\n            \"nation\" AS \"nation0\" (\"n_nationkey0\", \"n_name0\", \"n_regionkey0\", \"n_comment0\")\r\n        WHERE \"t4\".\"s_nationkey\" = \"nation0\".\"n_nationkey0\") AS \"t5\",\r\n        (SELECT *\r\n        FROM \"region\"\r\n        WHERE \"r_name\" = 'MIDDLE EAST') AS \"t6\"\r\nWHERE \"t5\".\"n_regionkey\" = \"t6\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")\r\nORDER BY 1\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 779799.51, "used_rules": ["FILTER_INTO_JOIN", "SORT_PROJECT_TRANSPOSE", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1683}
{"name": "query9_0", "input_sql": "select\n\tnation,\n\to_year,\n\tsum(amount) as sum_profit\nfrom\n\t(\n\t\tselect\n\t\t\tn_name as nation,\n\t\t\textract(year from o_orderdate) as o_year,\n\t\t\tl_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount\n\t\tfrom\n\t\t\tpart,\n\t\t\tsupplier,\n\t\t\tlineitem,\n\t\t\tpartsupp,\n\t\t\torders,\n\t\t\tnation\n\t\twhere\n\t\t\ts_suppkey = l_suppkey\n\t\t\tand ps_suppkey = l_suppkey\n\t\t\tand ps_partkey = l_partkey\n\t\t\tand p_partkey = l_partkey\n\t\t\tand o_orderkey = l_orderkey\n\t\t\tand s_nationkey = n_nationkey\n\t\t\tand p_name like '%cyan%'\n\t) as profit\ngroup by\n\tnation,\n\to_year\norder by\n\tnation,\n\to_year desc\nlimit 1;", "input_cost": 1869274.77, "output_sql": "SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") AS \"o_year\", COALESCE(SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\") - \"t2\".\"ps_supplycost\" * \"t2\".\"l_quantity\"), 0) AS \"sum_profit\"\r\nFROM (SELECT *\r\n        FROM (SELECT *\r\n                FROM (SELECT *\r\n                        FROM (SELECT *\r\n                                FROM \"part\"\r\n                                WHERE \"p_name\" LIKE '%cyan%') AS \"t\",\r\n                            \"supplier\",\r\n                            \"lineitem\"\r\n                        WHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\") AS \"t0\",\r\n                    \"partsupp\"\r\n                WHERE \"partsupp\".\"ps_suppkey\" = \"t0\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"t0\".\"l_partkey\") AS \"t1\",\r\n            \"orders\"\r\n        WHERE \"orders\".\"o_orderkey\" = \"t1\".\"l_orderkey\") AS \"t2\",\r\n    \"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", 2 DESC\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 936431.51, "used_rules": ["FILTER_INTO_JOIN", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1105}
{"name": "query9_1", "input_sql": "select\n\tnation,\n\to_year,\n\tsum(amount) as sum_profit\nfrom\n\t(\n\t\tselect\n\t\t\tn_name as nation,\n\t\t\textract(year from o_orderdate) as o_year,\n\t\t\tl_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount\n\t\tfrom\n\t\t\tpart,\n\t\t\tsupplier,\n\t\t\tlineitem,\n\t\t\tpartsupp,\n\t\t\torders,\n\t\t\tnation\n\t\twhere\n\t\t\ts_suppkey = l_suppkey\n\t\t\tand ps_suppkey = l_suppkey\n\t\t\tand ps_partkey = l_partkey\n\t\t\tand p_partkey = l_partkey\n\t\t\tand o_orderkey = l_orderkey\n\t\t\tand s_nationkey = n_nationkey\n\t\t\tand p_name like '%chiffon%'\n\t) as profit\ngroup by\n\tnation,\n\to_year\norder by\n\tnation,\n\to_year desc\nlimit 1;", "input_cost": 1834807.0, "output_sql": "SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") AS \"o_year\", COALESCE(SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\") - \"t2\".\"ps_supplycost\" * \"t2\".\"l_quantity\"), 0) AS \"sum_profit\"\r\nFROM (SELECT *\r\n        FROM (SELECT *\r\n                FROM (SELECT *\r\n                        FROM (SELECT *\r\n                                FROM \"part\"\r\n                                WHERE \"p_name\" LIKE '%chiffon%') AS \"t\",\r\n                            \"supplier\",\r\n                            \"lineitem\"\r\n                        WHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\") AS \"t0\",\r\n                    \"partsupp\"\r\n                WHERE \"partsupp\".\"ps_suppkey\" = \"t0\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"t0\".\"l_partkey\") AS \"t1\",\r\n            \"orders\"\r\n        WHERE \"orders\".\"o_orderkey\" = \"t1\".\"l_orderkey\") AS \"t2\",\r\n    \"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", 2 DESC\r\nFETCH NEXT 1 ROWS ONLY;", "output_cost": 985327.64, "used_rules": ["FILTER_INTO_JOIN", "AGGREGATE_REDUCE_FUNCTIONS", "PROJECT_TO_CALC", "JOIN_EXTRACT_FILTER"], "rewrite_time": 1146}
